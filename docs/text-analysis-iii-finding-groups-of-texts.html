<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Text Analysis III: Finding Groups of Texts | DH in AAS - TA with R (2022S)</title>
  <meta name="description" content="This is a collection of relevant materials for the class ‘57-528 ONLINE S: Digital Humanities in African and Asian Studies: Text Analysis with R’ (2022S), offered at the University of Hamburg (Afrika-Asien Institut) and taught by Maxim G. Romanov" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Text Analysis III: Finding Groups of Texts | DH in AAS - TA with R (2022S)" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://eis1600.github.io/course_TA_R_2022S/" />
  
  <meta property="og:description" content="This is a collection of relevant materials for the class ‘57-528 ONLINE S: Digital Humanities in African and Asian Studies: Text Analysis with R’ (2022S), offered at the University of Hamburg (Afrika-Asien Institut) and taught by Maxim G. Romanov" />
  <meta name="github-repo" content="EIS1600/course_TA_R_2022S" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Text Analysis III: Finding Groups of Texts | DH in AAS - TA with R (2022S)" />
  
  <meta name="twitter:description" content="This is a collection of relevant materials for the class ‘57-528 ONLINE S: Digital Humanities in African and Asian Studies: Text Analysis with R’ (2022S), offered at the University of Hamburg (Afrika-Asien Institut) and taught by Maxim G. Romanov" />
  

<meta name="author" content="Maxim G. Romanov" />


<meta name="date" content="2022-06-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="touch-icon.png" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="text-analysis-ii-distances-keywords-summarization.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DH Methods for Middle Eastern Studies: Text Mining with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Syllabus</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-details"><i class="fa fa-check"></i>Course Details</a></li>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#aims-contents-and-method-of-the-course"><i class="fa fa-check"></i><b>0.1</b> Aims, Contents and Method of the Course</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#course-evaluation"><i class="fa fa-check"></i><b>0.2</b> Course Evaluation</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#datacamp"><i class="fa fa-check"></i><b>0.2.1</b> DataCamp</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#class-participation"><i class="fa fa-check"></i><b>0.3</b> Class Participation</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#homework"><i class="fa fa-check"></i><b>0.4</b> Homework</a></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#final-project"><i class="fa fa-check"></i><b>0.5</b> Final Project</a></li>
<li class="chapter" data-level="0.6" data-path="index.html"><a href="index.html#practice-worksheets-r-notebooks"><i class="fa fa-check"></i><b>0.6</b> Practice Worksheets (R Notebooks)</a></li>
<li class="chapter" data-level="0.7" data-path="index.html"><a href="index.html#additional-study-materials"><i class="fa fa-check"></i><b>0.7</b> Additional Study Materials</a></li>
<li class="chapter" data-level="0.8" data-path="index.html"><a href="index.html#software-tools-technologies"><i class="fa fa-check"></i><b>0.8</b> Software, Tools, &amp; Technologies:</a></li>
<li class="chapter" data-level="0.9" data-path="index.html"><a href="index.html#submitting-homework"><i class="fa fa-check"></i><b>0.9</b> Submitting Homework:</a>
<ul>
<li class="chapter" data-level="0.9.1" data-path="index.html"><a href="index.html#handouts-workbooks"><i class="fa fa-check"></i><b>0.9.1</b> Handouts / Workbooks</a></li>
<li class="chapter" data-level="0.9.2" data-path="index.html"><a href="index.html#datacamp-assignments"><i class="fa fa-check"></i><b>0.9.2</b> DataCamp Assignments</a></li>
</ul></li>
<li class="chapter" data-level="0.10" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>0.10</b> Schedule</a></li>
<li class="chapter" data-level="0.11" data-path="index.html"><a href="index.html#lesson-topics-subject-to-modifications"><i class="fa fa-check"></i><b>0.11</b> Lesson Topics (<em>subject to modifications</em>)</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="general-introduction.html"><a href="general-introduction.html"><i class="fa fa-check"></i><b>1</b> General Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="general-introduction.html"><a href="general-introduction.html#L01_goals"><i class="fa fa-check"></i><b>1.1</b> Goals</a></li>
<li class="chapter" data-level="1.2" data-path="general-introduction.html"><a href="general-introduction.html#L01_sw"><i class="fa fa-check"></i><b>1.2</b> Software</a></li>
<li class="chapter" data-level="1.3" data-path="general-introduction.html"><a href="general-introduction.html#L01_class"><i class="fa fa-check"></i><b>1.3</b> Class</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="general-introduction.html"><a href="general-introduction.html#installing-rmarkdown"><i class="fa fa-check"></i><b>1.3.1</b> Installing <code>rmarkdown</code></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="general-introduction.html"><a href="general-introduction.html#starting-with-our-first-workbook"><i class="fa fa-check"></i><b>1.4</b> Starting with our first workbook:</a></li>
<li class="chapter" data-level="1.5" data-path="general-introduction.html"><a href="general-introduction.html#L01_topics"><i class="fa fa-check"></i><b>1.5</b> Topics covered</a></li>
<li class="chapter" data-level="1.6" data-path="general-introduction.html"><a href="general-introduction.html#L01_RM"><i class="fa fa-check"></i><b>1.6</b> Reference materials</a></li>
<li class="chapter" data-level="1.7" data-path="general-introduction.html"><a href="general-introduction.html#L01_HW"><i class="fa fa-check"></i><b>1.7</b> Homework</a></li>
<li class="chapter" data-level="1.8" data-path="general-introduction.html"><a href="general-introduction.html#L01_commonissues"><i class="fa fa-check"></i><b>1.8</b> Common issues with homework</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="general-introduction.html"><a href="general-introduction.html#tracing-errors"><i class="fa fa-check"></i><b>1.8.1</b> Tracing errors</a></li>
<li class="chapter" data-level="1.8.2" data-path="general-introduction.html"><a href="general-introduction.html#comments-commenting-out"><i class="fa fa-check"></i><b>1.8.2</b> Comments / Commenting out</a></li>
<li class="chapter" data-level="1.8.3" data-path="general-introduction.html"><a href="general-introduction.html#random-errors"><i class="fa fa-check"></i><b>1.8.3</b> Random errors:</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="general-introduction.html"><a href="general-introduction.html#L01_SHW"><i class="fa fa-check"></i><b>1.9</b> Submitting homework</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics-i-main-data-structures-in-r.html"><a href="basics-i-main-data-structures-in-r.html"><i class="fa fa-check"></i><b>2</b> Basics I: Main data structures in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basics-i-main-data-structures-in-r.html"><a href="basics-i-main-data-structures-in-r.html#goals02"><i class="fa fa-check"></i><b>2.1</b> Goals</a></li>
<li class="chapter" data-level="2.2" data-path="basics-i-main-data-structures-in-r.html"><a href="basics-i-main-data-structures-in-r.html#soft02"><i class="fa fa-check"></i><b>2.2</b> Software</a></li>
<li class="chapter" data-level="2.3" data-path="basics-i-main-data-structures-in-r.html"><a href="basics-i-main-data-structures-in-r.html#cLass02"><i class="fa fa-check"></i><b>2.3</b> Class</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="basics-i-main-data-structures-in-r.html"><a href="basics-i-main-data-structures-in-r.html#topics02"><i class="fa fa-check"></i><b>2.3.1</b> Topics: Data Structures &amp; Types</a></li>
<li class="chapter" data-level="2.3.2" data-path="basics-i-main-data-structures-in-r.html"><a href="basics-i-main-data-structures-in-r.html#additional_notes_02"><i class="fa fa-check"></i><b>2.3.2</b> Additional notes</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="basics-i-main-data-structures-in-r.html"><a href="basics-i-main-data-structures-in-r.html#RM02"><i class="fa fa-check"></i><b>2.4</b> Reference materials</a></li>
<li class="chapter" data-level="2.5" data-path="basics-i-main-data-structures-in-r.html"><a href="basics-i-main-data-structures-in-r.html#HW02"><i class="fa fa-check"></i><b>2.5</b> Homework</a></li>
<li class="chapter" data-level="2.6" data-path="basics-i-main-data-structures-in-r.html"><a href="basics-i-main-data-structures-in-r.html#L02_SHW"><i class="fa fa-check"></i><b>2.6</b> Submitting homework</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basics-ii-data-manipulation-exloratory-analysis.html"><a href="basics-ii-data-manipulation-exloratory-analysis.html"><i class="fa fa-check"></i><b>3</b> Basics II: Data Manipulation &amp; Exloratory Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basics-ii-data-manipulation-exloratory-analysis.html"><a href="basics-ii-data-manipulation-exloratory-analysis.html#goals03"><i class="fa fa-check"></i><b>3.1</b> Goals</a></li>
<li class="chapter" data-level="3.2" data-path="basics-ii-data-manipulation-exloratory-analysis.html"><a href="basics-ii-data-manipulation-exloratory-analysis.html#soft03"><i class="fa fa-check"></i><b>3.2</b> Software</a></li>
<li class="chapter" data-level="3.3" data-path="basics-ii-data-manipulation-exloratory-analysis.html"><a href="basics-ii-data-manipulation-exloratory-analysis.html#cLass03"><i class="fa fa-check"></i><b>3.3</b> Class</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basics-ii-data-manipulation-exloratory-analysis.html"><a href="basics-ii-data-manipulation-exloratory-analysis.html#topics03"><i class="fa fa-check"></i><b>3.3.1</b> Topics</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basics-ii-data-manipulation-exloratory-analysis.html"><a href="basics-ii-data-manipulation-exloratory-analysis.html#RM03"><i class="fa fa-check"></i><b>3.4</b> Reference materials</a></li>
<li class="chapter" data-level="3.5" data-path="basics-ii-data-manipulation-exloratory-analysis.html"><a href="basics-ii-data-manipulation-exloratory-analysis.html#HW03"><i class="fa fa-check"></i><b>3.5</b> Homework</a></li>
<li class="chapter" data-level="3.6" data-path="basics-ii-data-manipulation-exloratory-analysis.html"><a href="basics-ii-data-manipulation-exloratory-analysis.html#SHW03"><i class="fa fa-check"></i><b>3.6</b> Submitting homework</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basics-iii-data-visualization-functions.html"><a href="basics-iii-data-visualization-functions.html"><i class="fa fa-check"></i><b>4</b> Basics III: Data Visualization; Functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="basics-iii-data-visualization-functions.html"><a href="basics-iii-data-visualization-functions.html#goals04"><i class="fa fa-check"></i><b>4.1</b> Goals</a></li>
<li class="chapter" data-level="4.2" data-path="basics-iii-data-visualization-functions.html"><a href="basics-iii-data-visualization-functions.html#soft04"><i class="fa fa-check"></i><b>4.2</b> Software</a></li>
<li class="chapter" data-level="4.3" data-path="basics-iii-data-visualization-functions.html"><a href="basics-iii-data-visualization-functions.html#cLass04"><i class="fa fa-check"></i><b>4.3</b> Class</a></li>
<li class="chapter" data-level="4.4" data-path="basics-iii-data-visualization-functions.html"><a href="basics-iii-data-visualization-functions.html#topics04"><i class="fa fa-check"></i><b>4.4</b> Topics</a></li>
<li class="chapter" data-level="4.5" data-path="basics-iii-data-visualization-functions.html"><a href="basics-iii-data-visualization-functions.html#RM04"><i class="fa fa-check"></i><b>4.5</b> Reference materials</a></li>
<li class="chapter" data-level="4.6" data-path="basics-iii-data-visualization-functions.html"><a href="basics-iii-data-visualization-functions.html#HW04"><i class="fa fa-check"></i><b>4.6</b> Homework</a></li>
<li class="chapter" data-level="4.7" data-path="basics-iii-data-visualization-functions.html"><a href="basics-iii-data-visualization-functions.html#SHW04"><i class="fa fa-check"></i><b>4.7</b> Submitting homework</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html"><i class="fa fa-check"></i><b>5</b> Data I: Collecting, Organizing, Creating</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html#goals05"><i class="fa fa-check"></i><b>5.1</b> Goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html#soft05"><i class="fa fa-check"></i><b>5.2</b> Software</a></li>
<li class="chapter" data-level="5.3" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html#CA05"><i class="fa fa-check"></i><b>5.3</b> In Class I: <em>Theoretical and Conceptual</em></a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html#CaA05"><i class="fa fa-check"></i><b>5.3.1</b> Ways of obtaining data</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html#CbA05"><i class="fa fa-check"></i><b>5.3.2</b> Main format</a></li>
<li class="chapter" data-level="5.3.3" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html#CdA05"><i class="fa fa-check"></i><b>5.3.3</b> Basic principles of organizing data: <em>Tidy Data</em></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html#CB05"><i class="fa fa-check"></i><b>5.4</b> In Class II: <em>Practical</em></a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html#CaB05"><i class="fa fa-check"></i><b>5.4.1</b> Morris Dataset: <em>the East Vs. the West</em></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html#OCR05"><i class="fa fa-check"></i><b>5.5</b> OCR in R</a></li>
<li class="chapter" data-level="5.6" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html#rm05"><i class="fa fa-check"></i><b>5.6</b> Reference Materials:</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html#rmA05"><i class="fa fa-check"></i><b>5.6.1</b> Additional</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html#rmB05"><i class="fa fa-check"></i><b>5.6.2</b> Additional Readings</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html#HW05"><i class="fa fa-check"></i><b>5.7</b> Homework</a></li>
<li class="chapter" data-level="5.8" data-path="data-i-collecting-organizing-creating.html"><a href="data-i-collecting-organizing-creating.html#SHW05"><i class="fa fa-check"></i><b>5.8</b> Submitting homework</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-ii-modeling-manipulating.html"><a href="data-ii-modeling-manipulating.html"><i class="fa fa-check"></i><b>6</b> Data II: Modeling &amp; Manipulating</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-ii-modeling-manipulating.html"><a href="data-ii-modeling-manipulating.html#goals06"><i class="fa fa-check"></i><b>6.1</b> Goals:</a></li>
<li class="chapter" data-level="6.2" data-path="data-ii-modeling-manipulating.html"><a href="data-ii-modeling-manipulating.html#soft06"><i class="fa fa-check"></i><b>6.2</b> Software:</a></li>
<li class="chapter" data-level="6.3" data-path="data-ii-modeling-manipulating.html"><a href="data-ii-modeling-manipulating.html#InClassI06"><i class="fa fa-check"></i><b>6.3</b> In Class I: <em>Theoretical and Conceptual</em></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="data-ii-modeling-manipulating.html"><a href="data-ii-modeling-manipulating.html#DM06"><i class="fa fa-check"></i><b>6.3.1</b> Ways of modeling data: Categorization</a></li>
<li class="chapter" data-level="6.3.2" data-path="data-ii-modeling-manipulating.html"><a href="data-ii-modeling-manipulating.html#Norm06"><i class="fa fa-check"></i><b>6.3.2</b> Normalization</a></li>
<li class="chapter" data-level="6.3.3" data-path="data-ii-modeling-manipulating.html"><a href="data-ii-modeling-manipulating.html#Proxies06"><i class="fa fa-check"></i><b>6.3.3</b> Note: <em>Proxies</em>, <em>Features</em>, <em>Abstractions</em></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="data-ii-modeling-manipulating.html"><a href="data-ii-modeling-manipulating.html#InClassII06"><i class="fa fa-check"></i><b>6.4</b> In Class II: <em>Practical</em></a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="data-ii-modeling-manipulating.html"><a href="data-ii-modeling-manipulating.html#Si06"><i class="fa fa-check"></i><b>6.4.1</b> SECTION I.</a></li>
<li class="chapter" data-level="6.4.2" data-path="data-ii-modeling-manipulating.html"><a href="data-ii-modeling-manipulating.html#Sii06"><i class="fa fa-check"></i><b>6.4.2</b> SECTION II</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="data-ii-modeling-manipulating.html"><a href="data-ii-modeling-manipulating.html#RM06"><i class="fa fa-check"></i><b>6.5</b> Reference Materials</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="data-ii-modeling-manipulating.html"><a href="data-ii-modeling-manipulating.html#AR06"><i class="fa fa-check"></i><b>6.5.1</b> Additional Readings</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="data-ii-modeling-manipulating.html"><a href="data-ii-modeling-manipulating.html#HW06"><i class="fa fa-check"></i><b>6.6</b> Homework</a></li>
<li class="chapter" data-level="6.7" data-path="data-ii-modeling-manipulating.html"><a href="data-ii-modeling-manipulating.html#SHW06"><i class="fa fa-check"></i><b>6.7</b> Submitting homework</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html"><i class="fa fa-check"></i><b>7</b> Text Analysis I: Basics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#goals07"><i class="fa fa-check"></i><b>7.1</b> Goals</a></li>
<li class="chapter" data-level="7.2" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#Prelim07"><i class="fa fa-check"></i><b>7.2</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#Data07"><i class="fa fa-check"></i><b>7.2.1</b> Data</a></li>
<li class="chapter" data-level="7.2.2" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#Lib07"><i class="fa fa-check"></i><b>7.2.2</b> Libraries</a></li>
<li class="chapter" data-level="7.2.3" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#functions07"><i class="fa fa-check"></i><b>7.2.3</b> Functions in <code>R</code> (a refresher)</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#texts-and-text-analysis"><i class="fa fa-check"></i><b>7.3</b> Texts and Text Analysis</a></li>
<li class="chapter" data-level="7.4" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#word-frequencies-and-word-clouds"><i class="fa fa-check"></i><b>7.4</b> Word Frequencies and Word Clouds</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#word-frequencies"><i class="fa fa-check"></i><b>7.4.1</b> Word Frequencies</a></li>
<li class="chapter" data-level="7.4.2" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#wordclouds"><i class="fa fa-check"></i><b>7.4.2</b> Wordclouds</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#word-distribution-plots"><i class="fa fa-check"></i><b>7.5</b> Word Distribution Plots</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#simple-a-star-wars-example"><i class="fa fa-check"></i><b>7.5.1</b> Simple — a Star Wars Example</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#word-distribution-plots-with-frequencies-over-time"><i class="fa fa-check"></i><b>7.6</b> Word Distribution Plots: With Frequencies Over Time</a></li>
<li class="chapter" data-level="7.7" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#kwic-keywords-in-context"><i class="fa fa-check"></i><b>7.7</b> KWIC: Keywords-in-Context</a></li>
<li class="chapter" data-level="7.8" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#HW07"><i class="fa fa-check"></i><b>7.8</b> Homework</a></li>
<li class="chapter" data-level="7.9" data-path="text-analysis-i-basics.html"><a href="text-analysis-i-basics.html#SHW07"><i class="fa fa-check"></i><b>7.9</b> Submitting homework</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="text-analysis-ii-distances-keywords-summarization.html"><a href="text-analysis-ii-distances-keywords-summarization.html"><i class="fa fa-check"></i><b>8</b> Text Analysis II: Distances, Keywords, Summarization</a>
<ul>
<li class="chapter" data-level="8.1" data-path="text-analysis-ii-distances-keywords-summarization.html"><a href="text-analysis-ii-distances-keywords-summarization.html#goals08"><i class="fa fa-check"></i><b>8.1</b> Goals</a></li>
<li class="chapter" data-level="8.2" data-path="text-analysis-ii-distances-keywords-summarization.html"><a href="text-analysis-ii-distances-keywords-summarization.html#Prelim08"><i class="fa fa-check"></i><b>8.2</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="text-analysis-ii-distances-keywords-summarization.html"><a href="text-analysis-ii-distances-keywords-summarization.html#Data08"><i class="fa fa-check"></i><b>8.2.1</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="text-analysis-ii-distances-keywords-summarization.html"><a href="text-analysis-ii-distances-keywords-summarization.html#docsim08"><i class="fa fa-check"></i><b>8.3</b> Document similarity/distance measures: <code>text2vec</code> library</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="text-analysis-ii-distances-keywords-summarization.html"><a href="text-analysis-ii-distances-keywords-summarization.html#distance-measures-jaccard-index-cosine-similarity-euclidean-distance"><i class="fa fa-check"></i><b>8.3.1</b> Distance Measures: Jaccard index, Cosine similarity, Euclidean distance</a></li>
<li class="chapter" data-level="8.3.2" data-path="text-analysis-ii-distances-keywords-summarization.html"><a href="text-analysis-ii-distances-keywords-summarization.html#now-lets-run-this-on-dispatch"><i class="fa fa-check"></i><b>8.3.2</b> Now, let’s run this on “Dispatch”</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="text-analysis-ii-distances-keywords-summarization.html"><a href="text-analysis-ii-distances-keywords-summarization.html#tf-idf"><i class="fa fa-check"></i><b>8.4</b> TF-IDF</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="text-analysis-ii-distances-keywords-summarization.html"><a href="text-analysis-ii-distances-keywords-summarization.html#inaugural-speeches-of-the-us-presidents"><i class="fa fa-check"></i><b>8.4.1</b> Inaugural speeches of the US presidents</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="text-analysis-ii-distances-keywords-summarization.html"><a href="text-analysis-ii-distances-keywords-summarization.html#text-summarization"><i class="fa fa-check"></i><b>8.5</b> Text summarization</a></li>
<li class="chapter" data-level="8.6" data-path="text-analysis-ii-distances-keywords-summarization.html"><a href="text-analysis-ii-distances-keywords-summarization.html#HW08"><i class="fa fa-check"></i><b>8.6</b> Homework</a></li>
<li class="chapter" data-level="8.7" data-path="text-analysis-ii-distances-keywords-summarization.html"><a href="text-analysis-ii-distances-keywords-summarization.html#SHW08"><i class="fa fa-check"></i><b>8.7</b> Submitting homework</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html"><i class="fa fa-check"></i><b>9</b> Text Analysis III: Finding Groups of Texts</a>
<ul>
<li class="chapter" data-level="9.1" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#goals09"><i class="fa fa-check"></i><b>9.1</b> Goals</a></li>
<li class="chapter" data-level="9.2" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#Prelim09"><i class="fa fa-check"></i><b>9.2</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#libraries"><i class="fa fa-check"></i><b>9.2.1</b> Libraries</a></li>
<li class="chapter" data-level="9.2.2" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#tf-idf-1"><i class="fa fa-check"></i><b>9.2.2</b> TF-IDF</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#hierarchical-clustering"><i class="fa fa-check"></i><b>9.3</b> Hierarchical clustering</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#pca-viz-for-hclust"><i class="fa fa-check"></i><b>9.3.1</b> PCA viz for HCLUST</a></li>
<li class="chapter" data-level="9.3.2" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#determining-the-optimal-number-of-clusters-elbow-method-and-average-silhouette-method"><i class="fa fa-check"></i><b>9.3.2</b> Determining the optimal number of clusters: “Elbow Method” and “Average Silhouette Method”</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#k-means-clustering"><i class="fa fa-check"></i><b>9.4</b> K-means clustering</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#determining-the-optimal-number-of-clusters-elbow-method-and-average-silhouette-method-1"><i class="fa fa-check"></i><b>9.4.1</b> Determining the optimal number of clusters: “Elbow Method” and “Average Silhouette Method”</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#other-clustering-methods"><i class="fa fa-check"></i><b>9.5</b> Other “clustering” methods</a></li>
<li class="chapter" data-level="9.6" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#topic-modeling"><i class="fa fa-check"></i><b>9.6</b> Topic Modeling</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#topics"><i class="fa fa-check"></i><b>9.6.1</b> Topics?</a></li>
<li class="chapter" data-level="9.6.2" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#getting-to-code"><i class="fa fa-check"></i><b>9.6.2</b> Getting to code</a></li>
<li class="chapter" data-level="9.6.3" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#per-topic-per-word-probabilities-beta"><i class="fa fa-check"></i><b>9.6.3</b> Per-topic-per-word probabilities (<em>beta</em>)</a></li>
<li class="chapter" data-level="9.6.4" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#topics-over-time"><i class="fa fa-check"></i><b>9.6.4</b> Topics over time</a></li>
<li class="chapter" data-level="9.6.5" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#exploring-topics"><i class="fa fa-check"></i><b>9.6.5</b> Exploring topics</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#addendum-different-distances-code-sample"><i class="fa fa-check"></i><b>9.7</b> Addendum: different distances code sample</a></li>
<li class="chapter" data-level="9.8" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#HW09"><i class="fa fa-check"></i><b>9.8</b> Homework</a></li>
<li class="chapter" data-level="9.9" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#SHW09"><i class="fa fa-check"></i><b>9.9</b> Submitting homework</a></li>
<li class="chapter" data-level="9.10" data-path="text-analysis-iii-finding-groups-of-texts.html"><a href="text-analysis-iii-finding-groups-of-texts.html#SWH09"><i class="fa fa-check"></i><b>9.10</b> Additional Materials</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DH in AAS - TA with R (2022S)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="text-analysis-iii-finding-groups-of-texts" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Text Analysis III: Finding Groups of Texts</h1>
<div id="goals09" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Goals</h2>
<ul>
<li>introduce text clustering approaches that allow us find groups of thematically similar texts:
<ul>
<li>hierarchical clustering;</li>
<li>k-means clustering;</li>
<li>topic modeling;</li>
</ul></li>
</ul>
</div>
<div id="Prelim09" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Preliminaries</h2>
<div id="libraries" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Libraries</h3>
<p>The following are the libraries that we will need for this section. Install those that you do not have yet.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;ggplot2&quot;, &quot;LDAvis&quot;, &quot;readr&quot;, &quot;slam&quot;, &quot;stringr&quot;, &quot;tictoc&quot;, &quot;tidytext&quot;, &quot;tidyverse&quot;, &quot;tm&quot;, &quot;topicmodels&quot;)</span></span>
<span id="cb126-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="co"># general</span></span>
<span id="cb126-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb126-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="co"># text analysis specific</span></span>
<span id="cb126-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb126-8"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(slam)</span>
<span id="cb126-9"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb126-10"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb126-11"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb126-12"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span>
<span id="cb126-13"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(topicmodels)</span>
<span id="cb126-14"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-15"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(text2vec)</span>
<span id="cb126-16"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stylo)</span>
<span id="cb126-17"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-18"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)    <span class="co"># clustering algorithms</span></span>
<span id="cb126-19"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra) <span class="co"># clustering algorithms &amp; visualization</span></span>
<span id="cb126-20"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-21"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-21" aria-hidden="true" tabindex="-1"></a><span class="co"># extra</span></span>
<span id="cb126-22"><a href="text-analysis-iii-finding-groups-of-texts.html#cb126-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc) <span class="co"># to time operations</span></span></code></pre></div>
<div id="the-dispatch-data-preprocessing" class="section level4" number="9.2.1.1">
<h4><span class="header-section-number">9.2.1.1</span> The Dispatch Data: Preprocessing</h4>
<p>Texts for experiments:</p>
<ul>
<li><a href="./files/data/dispatch_1861.tsv">The Richmond Dispatch (1861)</a></li>
<li><a href="./files/data/dispatch_1862.tsv">The Richmond Dispatch (1862)</a></li>
<li><a href="./files/data/dispatch_1863.tsv">The Richmond Dispatch (1863)</a></li>
<li><a href="./files/data/dispatch_1864.tsv">The Richmond Dispatch (1864)</a></li>
</ul>
<p>Topic models, pretrained:</p>
<ul>
<li><a href="./files/data/d1864_lda_vem_25t_better.rda">Topic models trained on 1864</a></li>
<li><a href="./files/data/dispatch_lda_vem_better.rda">Topic models for testing LDAvis</a></li>
</ul>
<p>We will limit to only one year, but, of course, the results are always more interesting with more data…</p>
<p>Loading…</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb127-1" aria-hidden="true" tabindex="-1"></a>d1864 <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">&quot;./files/data/dispatch_1864.tsv&quot;</span>, <span class="at">encoding=</span><span class="st">&quot;UTF-8&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">quote=</span><span class="st">&quot;&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb127-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb127-2" aria-hidden="true" tabindex="-1"></a>d1864<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(d1864<span class="sc">$</span>date, <span class="at">format=</span><span class="st">&quot;%Y-%m-%d&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb128-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(d1864, <span class="dv">1</span>), <span class="at">table.attr =</span> <span class="st">&quot;class=</span><span class="sc">\&quot;</span><span class="st">striped</span><span class="sc">\&quot;</span><span class="st">&quot;</span>, <span class="at">format=</span><span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table class="striped">
<thead>
<tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:left;">
date
</th>
<th style="text-align:left;">
type
</th>
<th style="text-align:left;">
header
</th>
<th style="text-align:left;">
text
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1864-04-28_article_1
</td>
<td style="text-align:left;">
1864-04-28
</td>
<td style="text-align:left;">
article
</td>
<td style="text-align:left;">
The news.
</td>
<td style="text-align:left;">
The news. Yesterday was an unusual dull day, there being a great dearth in the news market, which was the subject of general remark. – The report which prevailed towards night, to the effect that a battle was progressing on the line of the Rapidan, we feel authorized to contradict. All was quiet when the Central train left Gordonsville yesterday evening. The cannonading heard in the direction of Germanna Ford, previously noticed, was caused by artillery practice.
</td>
</tr>
</tbody>
</table>
<p>Let’s remove low freq items:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb129-1" aria-hidden="true" tabindex="-1"></a>d1864_lowFreq <span class="ot">&lt;-</span> d1864 <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, text) <span class="sc">%&gt;%</span></span>
<span id="cb129-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(word, <span class="at">sort=</span><span class="cn">TRUE</span>)</span>
<span id="cb129-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb129-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(d1864_lowFreq)</span></code></pre></div>
<pre><code>##      word                 n            
##  Length:58774       Min.   :     1.00  
##  Class :character   1st Qu.:     1.00  
##  Mode  :character   Median :     2.00  
##                     Mean   :    61.63  
##                     3rd Qu.:     8.00  
##                     Max.   :278040.00</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb131-1" aria-hidden="true" tabindex="-1"></a>lowFreq <span class="ot">&lt;-</span> d1864_lowFreq <span class="sc">%&gt;%</span></span>
<span id="cb131-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&lt;=</span> <span class="dv">1</span>)</span>
<span id="cb131-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lowFreq)</span></code></pre></div>
<pre><code>##      word                 n    
##  Length:28107       Min.   :1  
##  Class :character   1st Qu.:1  
##  Mode  :character   Median :1  
##                     Mean   :1  
##                     3rd Qu.:1  
##                     Max.   :1</code></pre>
<p>Most of these low-frequency items are typos:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb133-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(lowFreq, <span class="dv">15</span>), <span class="at">table.attr =</span> <span class="st">&quot;class=</span><span class="sc">\&quot;</span><span class="st">striped</span><span class="sc">\&quot;</span><span class="st">&quot;</span>, <span class="at">format=</span><span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table class="striped">
<thead>
<tr>
<th style="text-align:left;">
word
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0001850holstein482
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
00024
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
0003750
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
0004unshelled
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
0005
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
000aliens
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
000anne
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
000another
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
000april
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
000august
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
000banks’s
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
000butchers5500blacksmiths2200wheelrights2200teamsters505
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
000butler’s
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
000california50
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
000connecticut40
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>We can <code>anti-join</code> our corpus with <code>lowFreq</code>, which will remove them:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb134-1" aria-hidden="true" tabindex="-1"></a>d1864_clean <span class="ot">&lt;-</span> d1864 <span class="sc">%&gt;%</span></span>
<span id="cb134-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">!=</span> <span class="st">&quot;ad_blank&quot;</span>)</span>
<span id="cb134-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb134-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb134-4" aria-hidden="true" tabindex="-1"></a>d1864_clean <span class="ot">&lt;-</span> d1864_clean <span class="sc">%&gt;%</span></span>
<span id="cb134-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, text) <span class="sc">%&gt;%</span></span>
<span id="cb134-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb134-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(lowFreq, <span class="at">by=</span><span class="st">&quot;word&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb134-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb134-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb134-8"><a href="text-analysis-iii-finding-groups-of-texts.html#cb134-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(word, <span class="at">sort=</span><span class="cn">TRUE</span>)</span>
<span id="cb134-9"><a href="text-analysis-iii-finding-groups-of-texts.html#cb134-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-10"><a href="text-analysis-iii-finding-groups-of-texts.html#cb134-10" aria-hidden="true" tabindex="-1"></a><span class="co"># unfiltered:      2,815,144</span></span>
<span id="cb134-11"><a href="text-analysis-iii-finding-groups-of-texts.html#cb134-11" aria-hidden="true" tabindex="-1"></a><span class="co"># filtered (&gt;3):   2,749,078</span></span></code></pre></div>
<p>Additionally, we need to remove <code>stop words</code>, but first we need to identify them.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb135-1" aria-hidden="true" tabindex="-1"></a>d1864_clean_FL <span class="ot">&lt;-</span> d1864_clean <span class="sc">%&gt;%</span></span>
<span id="cb135-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(word) <span class="sc">%&gt;%</span></span>
<span id="cb135-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">freq=</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb135-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(freq))</span>
<span id="cb135-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb135-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(d1864_clean_FL, <span class="dv">15</span>), <span class="at">table.attr =</span> <span class="st">&quot;class=</span><span class="sc">\&quot;</span><span class="st">striped</span><span class="sc">\&quot;</span><span class="st">&quot;</span>, <span class="at">format=</span><span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table class="striped">
<thead>
<tr>
<th style="text-align:left;">
word
</th>
<th style="text-align:right;">
freq
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
the
</td>
<td style="text-align:right;">
278040
</td>
</tr>
<tr>
<td style="text-align:left;">
of
</td>
<td style="text-align:right;">
163446
</td>
</tr>
<tr>
<td style="text-align:left;">
and
</td>
<td style="text-align:right;">
114985
</td>
</tr>
<tr>
<td style="text-align:left;">
to
</td>
<td style="text-align:right;">
98596
</td>
</tr>
<tr>
<td style="text-align:left;">
in
</td>
<td style="text-align:right;">
68070
</td>
</tr>
<tr>
<td style="text-align:left;">
a
</td>
<td style="text-align:right;">
67022
</td>
</tr>
<tr>
<td style="text-align:left;">
that
</td>
<td style="text-align:right;">
35265
</td>
</tr>
<tr>
<td style="text-align:left;">
for
</td>
<td style="text-align:right;">
32885
</td>
</tr>
<tr>
<td style="text-align:left;">
on
</td>
<td style="text-align:right;">
31679
</td>
</tr>
<tr>
<td style="text-align:left;">
was
</td>
<td style="text-align:right;">
30730
</td>
</tr>
<tr>
<td style="text-align:left;">
is
</td>
<td style="text-align:right;">
29191
</td>
</tr>
<tr>
<td style="text-align:left;">
at
</td>
<td style="text-align:right;">
27723
</td>
</tr>
<tr>
<td style="text-align:left;">
be
</td>
<td style="text-align:right;">
27673
</td>
</tr>
<tr>
<td style="text-align:left;">
by
</td>
<td style="text-align:right;">
26285
</td>
</tr>
<tr>
<td style="text-align:left;">
from
</td>
<td style="text-align:right;">
24300
</td>
</tr>
</tbody>
</table>
<p>To make things faster, you can remove top 50, 100, 150, 200 most frequent words, but this is a rather brutal way. Ideally, you want to curate your own stop word list that will be tuned to your texts. Below, I have taken top 500 words and manually removed everything that was meaningful (or, better, what I <em>considered</em> meaningful). Additionally, there are also NLP procedures that are designed to lemmatize words (i.e., reduce all words to their dictionary forms) and also do part-of-speech tagging, which allows to remove words categorically (for example, keeping only nouns, adjectives and verbs).</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb136-1" aria-hidden="true" tabindex="-1"></a>word <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;the&quot;</span>, <span class="st">&quot;of&quot;</span>, <span class="st">&quot;and&quot;</span>, <span class="st">&quot;to&quot;</span>, <span class="st">&quot;in&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;that&quot;</span>, <span class="st">&quot;for&quot;</span>, <span class="st">&quot;on&quot;</span>, <span class="st">&quot;was&quot;</span>, <span class="st">&quot;is&quot;</span>, <span class="st">&quot;at&quot;</span>, <span class="st">&quot;be&quot;</span>, <span class="st">&quot;by&quot;</span>, <span class="st">&quot;from&quot;</span>, <span class="st">&quot;his&quot;</span>, <span class="st">&quot;he&quot;</span>, <span class="st">&quot;it&quot;</span>, <span class="st">&quot;with&quot;</span>, <span class="st">&quot;as&quot;</span>, <span class="st">&quot;this&quot;</span>, <span class="st">&quot;will&quot;</span>, <span class="st">&quot;which&quot;</span>, <span class="st">&quot;have&quot;</span>, <span class="st">&quot;or&quot;</span>, <span class="st">&quot;are&quot;</span>, <span class="st">&quot;they&quot;</span>, <span class="st">&quot;their&quot;</span>, <span class="st">&quot;not&quot;</span>, <span class="st">&quot;were&quot;</span>, <span class="st">&quot;been&quot;</span>, <span class="st">&quot;has&quot;</span>, <span class="st">&quot;our&quot;</span>, <span class="st">&quot;we&quot;</span>, <span class="st">&quot;all&quot;</span>, <span class="st">&quot;but&quot;</span>, <span class="st">&quot;one&quot;</span>, <span class="st">&quot;had&quot;</span>, <span class="st">&quot;who&quot;</span>, <span class="st">&quot;an&quot;</span>, <span class="st">&quot;no&quot;</span>, <span class="st">&quot;i&quot;</span>, <span class="st">&quot;them&quot;</span>, <span class="st">&quot;about&quot;</span>, <span class="st">&quot;him&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;upon&quot;</span>, <span class="st">&quot;may&quot;</span>, <span class="st">&quot;there&quot;</span>, <span class="st">&quot;any&quot;</span>, <span class="st">&quot;some&quot;</span>, <span class="st">&quot;so&quot;</span>, <span class="st">&quot;men&quot;</span>, <span class="st">&quot;when&quot;</span>, <span class="st">&quot;if&quot;</span>, <span class="st">&quot;day&quot;</span>, <span class="st">&quot;her&quot;</span>, <span class="st">&quot;under&quot;</span>, <span class="st">&quot;would&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;such&quot;</span>, <span class="st">&quot;made&quot;</span>, <span class="st">&quot;up&quot;</span>, <span class="st">&quot;last&quot;</span>, <span class="st">&quot;j&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;years&quot;</span>, <span class="st">&quot;other&quot;</span>, <span class="st">&quot;into&quot;</span>, <span class="st">&quot;said&quot;</span>, <span class="st">&quot;new&quot;</span>, <span class="st">&quot;very&quot;</span>, <span class="st">&quot;five&quot;</span>, <span class="st">&quot;after&quot;</span>, <span class="st">&quot;out&quot;</span>, <span class="st">&quot;these&quot;</span>, <span class="st">&quot;shall&quot;</span>, <span class="st">&quot;my&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;more&quot;</span>, <span class="st">&quot;its&quot;</span>, <span class="st">&quot;now&quot;</span>, <span class="st">&quot;before&quot;</span>, <span class="st">&quot;three&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;than&quot;</span>, <span class="st">&quot;h&quot;</span>, <span class="st">&quot;o&#39;clock&quot;</span>, <span class="st">&quot;old&quot;</span>, <span class="st">&quot;being&quot;</span>, <span class="st">&quot;left&quot;</span>, <span class="st">&quot;can&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;man&quot;</span>, <span class="st">&quot;only&quot;</span>, <span class="st">&quot;same&quot;</span>, <span class="st">&quot;act&quot;</span>, <span class="st">&quot;first&quot;</span>, <span class="st">&quot;between&quot;</span>, <span class="st">&quot;above&quot;</span>, <span class="st">&quot;she&quot;</span>, <span class="st">&quot;you&quot;</span>, <span class="st">&quot;place&quot;</span>, <span class="st">&quot;following&quot;</span>, <span class="st">&quot;do&quot;</span>, <span class="st">&quot;per&quot;</span>, <span class="st">&quot;every&quot;</span>, <span class="st">&quot;most&quot;</span>, <span class="st">&quot;near&quot;</span>, <span class="st">&quot;us&quot;</span>, <span class="st">&quot;good&quot;</span>, <span class="st">&quot;should&quot;</span>, <span class="st">&quot;having&quot;</span>, <span class="st">&quot;great&quot;</span>, <span class="st">&quot;also&quot;</span>, <span class="st">&quot;over&quot;</span>, <span class="st">&quot;r&quot;</span>, <span class="st">&quot;could&quot;</span>, <span class="st">&quot;twenty&quot;</span>, <span class="st">&quot;people&quot;</span>, <span class="st">&quot;those&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;without&quot;</span>, <span class="st">&quot;four&quot;</span>, <span class="st">&quot;received&quot;</span>, <span class="st">&quot;p&quot;</span>, <span class="st">&quot;then&quot;</span>, <span class="st">&quot;what&quot;</span>, <span class="st">&quot;well&quot;</span>, <span class="st">&quot;where&quot;</span>, <span class="st">&quot;must&quot;</span>, <span class="st">&quot;says&quot;</span>, <span class="st">&quot;g&quot;</span>, <span class="st">&quot;large&quot;</span>, <span class="st">&quot;against&quot;</span>, <span class="st">&quot;back&quot;</span>, <span class="st">&quot;000&quot;</span>, <span class="st">&quot;through&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;off&quot;</span>, <span class="st">&quot;few&quot;</span>, <span class="st">&quot;me&quot;</span>, <span class="st">&quot;sent&quot;</span>, <span class="st">&quot;while&quot;</span>, <span class="st">&quot;make&quot;</span>, <span class="st">&quot;number&quot;</span>, <span class="st">&quot;many&quot;</span>, <span class="st">&quot;much&quot;</span>, <span class="st">&quot;give&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;six&quot;</span>, <span class="st">&quot;down&quot;</span>, <span class="st">&quot;several&quot;</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;since&quot;</span>, <span class="st">&quot;little&quot;</span>, <span class="st">&quot;during&quot;</span>, <span class="st">&quot;away&quot;</span>, <span class="st">&quot;until&quot;</span>, <span class="st">&quot;each&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;present&quot;</span>, <span class="st">&quot;own&quot;</span>, <span class="st">&quot;t&quot;</span>, <span class="st">&quot;here&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;found&quot;</span>, <span class="st">&quot;reported&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;right&quot;</span>, <span class="st">&quot;given&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="st">&quot;your&quot;</span>, <span class="st">&quot;way&quot;</span>, <span class="st">&quot;side&quot;</span>, <span class="st">&quot;did&quot;</span>, <span class="st">&quot;part&quot;</span>, <span class="st">&quot;long&quot;</span>, <span class="st">&quot;next&quot;</span>, <span class="st">&quot;fifty&quot;</span>, <span class="st">&quot;another&quot;</span>, <span class="st">&quot;1st&quot;</span>, <span class="st">&quot;whole&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;still&quot;</span>, <span class="st">&quot;among&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;within&quot;</span>, <span class="st">&quot;get&quot;</span>, <span class="st">&quot;named&quot;</span>, <span class="st">&quot;f&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;himself&quot;</span>, <span class="st">&quot;ten&quot;</span>, <span class="st">&quot;both&quot;</span>, <span class="st">&quot;nothing&quot;</span>, <span class="st">&quot;again&quot;</span>, <span class="st">&quot;n&quot;</span>, <span class="st">&quot;thirty&quot;</span>, <span class="st">&quot;eight&quot;</span>, <span class="st">&quot;took&quot;</span>, <span class="st">&quot;never&quot;</span>, <span class="st">&quot;came&quot;</span>, <span class="st">&quot;called&quot;</span>, <span class="st">&quot;small&quot;</span>, <span class="st">&quot;passed&quot;</span>, <span class="st">&quot;just&quot;</span>, <span class="st">&quot;brought&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;further&quot;</span>, <span class="st">&quot;yet&quot;</span>, <span class="st">&quot;half&quot;</span>, <span class="st">&quot;far&quot;</span>, <span class="st">&quot;held&quot;</span>, <span class="st">&quot;soon&quot;</span>, <span class="st">&quot;main&quot;</span>, <span class="st">&quot;8&quot;</span>, <span class="st">&quot;second&quot;</span>, <span class="st">&quot;however&quot;</span>, <span class="st">&quot;say&quot;</span>, <span class="st">&quot;heavy&quot;</span>, <span class="st">&quot;thus&quot;</span>, <span class="st">&quot;hereby&quot;</span>, <span class="st">&quot;even&quot;</span>, <span class="st">&quot;ran&quot;</span>, <span class="st">&quot;come&quot;</span>, <span class="st">&quot;whom&quot;</span>, <span class="st">&quot;like&quot;</span>, <span class="st">&quot;cannot&quot;</span>, <span class="st">&quot;head&quot;</span>, <span class="st">&quot;ever&quot;</span>, <span class="st">&quot;themselves&quot;</span>, <span class="st">&quot;put&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;cause&quot;</span>, <span class="st">&quot;known&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;go&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;once&quot;</span>, <span class="st">&quot;therefore&quot;</span>, <span class="st">&quot;thursday&quot;</span>, <span class="st">&quot;full&quot;</span>, <span class="st">&quot;apply&quot;</span>, <span class="st">&quot;see&quot;</span>, <span class="st">&quot;though&quot;</span>, <span class="st">&quot;seven&quot;</span>, <span class="st">&quot;tuesday&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;done&quot;</span>, <span class="st">&quot;whose&quot;</span>, <span class="st">&quot;let&quot;</span>, <span class="st">&quot;how&quot;</span>, <span class="st">&quot;making&quot;</span>, <span class="st">&quot;immediately&quot;</span>, <span class="st">&quot;forty&quot;</span>, <span class="st">&quot;early&quot;</span>, <span class="st">&quot;wednesday&quot;</span>, <span class="st">&quot;either&quot;</span>, <span class="st">&quot;too&quot;</span>, <span class="st">&quot;amount&quot;</span>, <span class="st">&quot;fact&quot;</span>, <span class="st">&quot;heard&quot;</span>, <span class="st">&quot;receive&quot;</span>, <span class="st">&quot;short&quot;</span>, <span class="st">&quot;less&quot;</span>, <span class="st">&quot;100&quot;</span>, <span class="st">&quot;know&quot;</span>, <span class="st">&quot;might&quot;</span>, <span class="st">&quot;except&quot;</span>, <span class="st">&quot;supposed&quot;</span>, <span class="st">&quot;others&quot;</span>, <span class="st">&quot;doubt&quot;</span>, <span class="st">&quot;set&quot;</span>, <span class="st">&quot;works&quot;</span>) </span>
<span id="cb136-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb136-3" aria-hidden="true" tabindex="-1"></a>sWordsDF <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(word)</span>
<span id="cb136-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb136-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb136-5" aria-hidden="true" tabindex="-1"></a>d1864_clean_minusSW <span class="ot">&lt;-</span> d1864_clean <span class="sc">%&gt;%</span></span>
<span id="cb136-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb136-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(sWordsDF, <span class="at">by=</span><span class="st">&quot;word&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(d1864_clean)</span></code></pre></div>
<pre><code>## [1] 1765298       3</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1,759,828</span></span></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(d1864_clean_minusSW)</span></code></pre></div>
<pre><code>## [1] 1162644       3</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1,159,214</span></span></code></pre></div>
</div>
</div>
<div id="tf-idf-1" class="section level3" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> TF-IDF</h3>
<blockquote>
<p><strong>From Wikipedia</strong>: In information retrieval, tf–idf or TFIDF, short for term frequency–inverse document frequency, is a numerical statistic that is intended to reflect how important a word is to a document in a collection or corpus.[1] It is often used as a weighting factor in searches of information retrieval, text mining, and user modeling. The tf–idf value increases proportionally to the number of times a word appears in the document and is offset by the number of documents in the corpus that contain the word, which helps to adjust for the fact that some words appear more frequently in general. tf–idf is one of the most popular term-weighting schemes today; 83% of text-based recommender systems in digital libraries use tf–idf. Variations of the tf–idf weighting scheme are often used by search engines as a central tool in scoring and ranking a document’s relevance given a user query. tf–idf can be successfully used for stop-words filtering in various subject fields, including text summarization and classification. One of the simplest ranking functions is computed by summing the tf–idf for each query term; many more sophisticated ranking functions are variants of this simple model.</p>
</blockquote>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb143-1" aria-hidden="true" tabindex="-1"></a>df_TF_IDF <span class="ot">&lt;-</span> d1864_clean_minusSW <span class="sc">%&gt;%</span> <span class="co"># d1864_clean, d1864_clean_minusSW</span></span>
<span id="cb143-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_tf_idf</span>(word, id, n) <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span></span>
<span id="cb143-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb143-4" aria-hidden="true" tabindex="-1"></a>  ungroup</span>
<span id="cb143-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb143-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(df_TF_IDF, <span class="dv">15</span>), <span class="at">table.attr =</span> <span class="st">&quot;class=</span><span class="sc">\&quot;</span><span class="st">striped</span><span class="sc">\&quot;</span><span class="st">&quot;</span>, <span class="at">format=</span><span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table class="striped">
<thead>
<tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:left;">
word
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
tf
</th>
<th style="text-align:right;">
idf
</th>
<th style="text-align:right;">
tf_idf
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1864-07-25_article_6
</td>
<td style="text-align:left;">
suicides
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.2500000
</td>
<td style="text-align:right;">
9.589941
</td>
<td style="text-align:right;">
2.397485
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-09-12_advert_131
</td>
<td style="text-align:left;">
leonard’s
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.2307692
</td>
<td style="text-align:right;">
8.896793
</td>
<td style="text-align:right;">
2.053106
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-02-05_article_19
</td>
<td style="text-align:left;">
sissy
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.2000000
</td>
<td style="text-align:right;">
9.589941
</td>
<td style="text-align:right;">
1.917988
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-01-28_article_49
</td>
<td style="text-align:left;">
generality
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.2500000
</td>
<td style="text-align:right;">
7.644030
</td>
<td style="text-align:right;">
1.911008
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-01-11_advert_105
</td>
<td style="text-align:left;">
blacking
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.2307692
</td>
<td style="text-align:right;">
8.203646
</td>
<td style="text-align:right;">
1.893149
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-09-12_advert_131
</td>
<td style="text-align:left;">
pills
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.2307692
</td>
<td style="text-align:right;">
8.203646
</td>
<td style="text-align:right;">
1.893149
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-12-08_article_70
</td>
<td style="text-align:left;">
council
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.4000000
</td>
<td style="text-align:right;">
4.508536
</td>
<td style="text-align:right;">
1.803414
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-12-12_advert_143
</td>
<td style="text-align:left;">
alf
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.1818182
</td>
<td style="text-align:right;">
9.589941
</td>
<td style="text-align:right;">
1.743626
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-09-27_article_95
</td>
<td style="text-align:left;">
calendar
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.2857143
</td>
<td style="text-align:right;">
6.006422
</td>
<td style="text-align:right;">
1.716120
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-03-22_article_71
</td>
<td style="text-align:left;">
apartments
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.2222222
</td>
<td style="text-align:right;">
7.644030
</td>
<td style="text-align:right;">
1.698673
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-12-29_article_42
</td>
<td style="text-align:left;">
dishonest
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.2500000
</td>
<td style="text-align:right;">
6.756727
</td>
<td style="text-align:right;">
1.689182
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-09-10_article_61
</td>
<td style="text-align:left;">
mobile
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.5000000
</td>
<td style="text-align:right;">
3.373334
</td>
<td style="text-align:right;">
1.686667
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-05-05_article_17
</td>
<td style="text-align:left;">
ling
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.2000000
</td>
<td style="text-align:right;">
8.203646
</td>
<td style="text-align:right;">
1.640729
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-09-26_article_63
</td>
<td style="text-align:left;">
hoy
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.2000000
</td>
<td style="text-align:right;">
8.203646
</td>
<td style="text-align:right;">
1.640729
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-03-30_article_50
</td>
<td style="text-align:left;">
telegrams
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.3333333
</td>
<td style="text-align:right;">
4.810817
</td>
<td style="text-align:right;">
1.603606
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb144-1" aria-hidden="true" tabindex="-1"></a>articleID <span class="ot">=</span> <span class="st">&quot;1864-07-25_article_6&quot;</span></span>
<span id="cb144-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(df_TF_IDF, id<span class="sc">==</span>articleID) <span class="sc">%&gt;%</span></span>
<span id="cb144-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(tf_idf))</span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##   id                   word          n    tf   idf tf_idf
##   &lt;chr&gt;                &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1 1864-07-25_article_6 suicides      2 0.25   9.59  2.40 
## 2 1864-07-25_article_6 france        2 0.25   4.35  1.09 
## 3 1864-07-25_article_6 suicide       1 0.125  6.50  0.812
## 4 1864-07-25_article_6 committed     1 0.125  3.09  0.387
## 5 1864-07-25_article_6 persons       1 0.125  2.61  0.327
## 6 1864-07-25_article_6 take          1 0.125  2.26  0.283</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb146-1" aria-hidden="true" tabindex="-1"></a>d1864<span class="sc">$</span>text[d1864<span class="sc">$</span>id<span class="sc">==</span>articleID]</span></code></pre></div>
<pre><code>## [1] &quot;Suicides in France -- More than ten suicides take place every day in France; last year 4, 000 persons committed suicide.&quot;</code></pre>
</div>
</div>
<div id="hierarchical-clustering" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Hierarchical clustering</h2>
<p>Clustering is a method to break items into closely related groups—clusters. The code below show how our data can be broken into clusters with hierarchical clustering, using distance matrices. Hierarchical clustering has rather high precision, but sensitive to outliers and computationally expensive, which makes it nearly unusable with large datasets. K-means clustering is more suitable for large datasets, but struggles with uniform data. <!--([for example](https://www.inovex.de/blog/disadvantages-of-k-means-clustering/))--> In both cases you have to define the number of clusters.</p>
<p>In what follows, we take our TF-IDF data, sample it, and run cluster analysis on a small sample. The chunk below simply prepares our data for analysis:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RANDOMLY SELECT N ITEMS</span></span>
<span id="cb148-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">48965</span>)</span>
<span id="cb148-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb148-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-4" aria-hidden="true" tabindex="-1"></a>sampledIDs <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">unique</span>(df_TF_IDF<span class="sc">$</span>id), N)</span>
<span id="cb148-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-5" aria-hidden="true" tabindex="-1"></a>sample_d1864_tfidf <span class="ot">&lt;-</span> df_TF_IDF <span class="sc">%&gt;%</span> <span class="fu">filter</span>(id <span class="sc">%in%</span> sampledIDs) <span class="sc">%&gt;%</span></span>
<span id="cb148-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, word, tf_idf)</span>
<span id="cb148-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-8"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="co"># CONVERT INTO DTM MATRIX</span></span>
<span id="cb148-9"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sample_d1864_tfidf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;document&quot;</span>, <span class="st">&quot;term&quot;</span>, <span class="st">&quot;count&quot;</span>)</span>
<span id="cb148-10"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-10" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">tibble</span>(sample_d1864_tfidf) <span class="sc">%&gt;%</span> <span class="fu">cast_dtm</span>(document, term, count)</span>
<span id="cb148-11"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-11" aria-hidden="true" tabindex="-1"></a>sample_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sample)</span>
<span id="cb148-12"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-13"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="co"># CONVERT INTO REGULAR MATRIC AND CALCULATE DISTANCES</span></span>
<span id="cb148-14"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-14" aria-hidden="true" tabindex="-1"></a>distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist.cosine</span>(sample_matrix) <span class="co"># from library(stylo)</span></span>
<span id="cb148-15"><a href="text-analysis-iii-finding-groups-of-texts.html#cb148-15" aria-hidden="true" tabindex="-1"></a>distanceMatrixHC <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(distanceMatrix)</span></code></pre></div>
<p>Now we can do the actual clustering. There are several clustering/linkage methods that can be used for clustering, and it usually depends on your goals.</p>
<blockquote>
<p><strong>From <code>?hclust</code></strong>: “A number of different clustering methods are provided. Ward’s minimum variance method aims at finding compact, spherical clusters. The complete linkage method finds similar clusters. The single linkage method (which is closely related to the minimal spanning tree) adopts a ‘friends of friends’ clustering strategy. The other methods can be regarded as aiming for clusters with characteristics somewhere between the single and complete link methods. Note however, that methods”median” and “centroid” are not leading to a monotone distance measure, or equivalently the resulting dendrograms can have so called inversions or reversals which are hard to interpret …”</p>
</blockquote>
<p>As a rule of thumb: you want balanced trees when you want an even number of items assigned to each cluster. Unbalanced trees are useful for finding outliers — with this method you can find which items you might want to remove in order to achieve better clustering.</p>
<p>You can find additional explanations <a href="https://www.saedsayad.com/clustering_hierarchical.htm">here</a>, <a href="https://towardsdatascience.com/introduction-hierarchical-clustering-d3066c6b560e#:~:text=There%20are%20two%20types%20of,agglomerative%20(bottom%2Dup)">here</a>, and <a href="https://en.wikipedia.org/wiki/Hierarchical_clustering">here</a>.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># THE FOLLOWING IS THE ACTUAL CLUSTERING   </span></span>
<span id="cb149-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb149-2" aria-hidden="true" tabindex="-1"></a>clustered.data.ward <span class="ot">&lt;-</span> <span class="fu">hclust</span>(distanceMatrixHC, <span class="at">method =</span> <span class="st">&quot;ward.D&quot;</span>)</span>
<span id="cb149-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb149-3" aria-hidden="true" tabindex="-1"></a>clustered.data.complete <span class="ot">&lt;-</span> <span class="fu">hclust</span>(distanceMatrixHC, <span class="at">method =</span> <span class="st">&quot;complete&quot;</span>)</span>
<span id="cb149-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb149-4" aria-hidden="true" tabindex="-1"></a>clustered.data.average <span class="ot">&lt;-</span> <span class="fu">hclust</span>(distanceMatrixHC, <span class="at">method =</span> <span class="st">&quot;average&quot;</span>)</span>
<span id="cb149-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb149-5" aria-hidden="true" tabindex="-1"></a>clustered.data.single <span class="ot">&lt;-</span> <span class="fu">hclust</span>(distanceMatrixHC, <span class="at">method =</span> <span class="st">&quot;single&quot;</span>)</span>
<span id="cb149-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb149-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb149-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(clustered.data.ward)</span></code></pre></div>
<pre><code>## List of 7
##  $ merge      : int [1:99, 1:2] -23 -2 -58 -99 -52 -3 -51 -60 -86 -17 ...
##  $ height     : num [1:99] 0.699 0.714 0.732 0.733 0.758 ...
##  $ order      : int [1:100] 51 23 72 86 52 58 89 32 60 61 ...
##  $ labels     : chr [1:100] &quot;1864-10-10_printrun_6&quot; &quot;1864-04-16_article_26&quot; &quot;1864-10-01_ad-blank_69&quot; &quot;1864-03-23_article_58&quot; ...
##  $ method     : chr &quot;ward.D&quot;
##  $ call       : language hclust(d = distanceMatrixHC, method = &quot;ward.D&quot;)
##  $ dist.method: NULL
##  - attr(*, &quot;class&quot;)= chr &quot;hclust&quot;</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clustered.data.ward, <span class="at">labels=</span><span class="cn">FALSE</span>, <span class="at">main=</span><span class="st">&quot;Ward&quot;</span>)</span>
<span id="cb151-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.25</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb151-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(clustered.data.ward, <span class="at">k=</span><span class="dv">10</span>, <span class="at">border=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
<p>You can use <code>rect.hclust()</code> either with <code>h=</code> — which will <em>cut tree</em> at a given height, thus determining the number of clusters; or, with <code>k=</code> — which will <em>cut tree</em> into a given number of clusters.</p>
<div id="pca-viz-for-hclust" class="section level3" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> PCA viz for HCLUST</h3>
<p>Note that PCA (principal component analysis) and clustering are not the same, but PCA can be also used to visualize hierarchical clustering:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb152-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb152-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb152-4" aria-hidden="true" tabindex="-1"></a>distanceMatrixHC.scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(distanceMatrixHC)</span>
<span id="cb152-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb152-5" aria-hidden="true" tabindex="-1"></a>hc.cut <span class="ot">&lt;-</span> <span class="fu">hcut</span>(distanceMatrixHC.scaled, <span class="at">k =</span> <span class="dv">3</span>, <span class="at">hc_method =</span> <span class="st">&quot;ward.D&quot;</span>)</span>
<span id="cb152-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(hc.cut, <span class="at">labelsize=</span><span class="dv">0</span>, <span class="at">ellipse.type =</span> <span class="st">&quot;convex&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clustered.data.complete, <span class="at">labels=</span><span class="cn">FALSE</span>, <span class="at">main=</span><span class="st">&quot;Complete&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clustered.data.average, <span class="at">labels=</span><span class="cn">FALSE</span>, <span class="at">main=</span><span class="st">&quot;Average&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(clustered.data.single, <span class="at">labels=</span><span class="cn">FALSE</span>, <span class="at">main=</span><span class="st">&quot;Single&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<p><code>hclust()</code> creates an object from which you can extract further information. For example, we can use <code>cutree()</code> function to extract clustering information. You can use <code>cutree()</code> either with <code>h=</code> — which will <em>cut tree</em> at a given height, thus determining the number of clusters; or, with <code>k=</code> — which will <em>cut tree</em> into a given number of clusters.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb156-1" aria-hidden="true" tabindex="-1"></a>clusters_named_vector <span class="ot">&lt;-</span> <span class="fu">cutree</span>(clustered.data.ward, <span class="at">k=</span><span class="dv">10</span>)</span>
<span id="cb156-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb156-2" aria-hidden="true" tabindex="-1"></a>clusters_df <span class="ot">&lt;-</span> <span class="fu">stack</span>(clusters_named_vector)</span>
<span id="cb156-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(clusters_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;cluster&quot;</span>, <span class="st">&quot;id&quot;</span>)</span>
<span id="cb156-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb156-4" aria-hidden="true" tabindex="-1"></a>clusters_df <span class="ot">&lt;-</span> clusters_df <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, cluster)</span>
<span id="cb156-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb156-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb156-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(clusters_df, <span class="dv">15</span>), <span class="at">table.attr =</span> <span class="st">&quot;class=</span><span class="sc">\&quot;</span><span class="st">striped</span><span class="sc">\&quot;</span><span class="st">&quot;</span>, <span class="at">format=</span><span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table class="striped">
<thead>
<tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
cluster
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1864-10-10_printrun_6
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-04-16_article_26
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-10-01_ad-blank_69
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-03-23_article_58
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-08-23_article_36
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-05-09_advert_47
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-01-06_article_114
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-04-14_article_39
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-12-12_advert_116
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-10-12_article_14
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-10-27_advert_59
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-07-11_advert_55
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-03-09_article_53
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-09-12_advert_4
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
1864-01-07_article_68
</td>
<td style="text-align:right;">
4
</td>
</tr>
</tbody>
</table>
<p>We can then <code>left_join</code> these clustering results with the original table and manually check if our clustering makes sense.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb157-1" aria-hidden="true" tabindex="-1"></a>d1864_clustering <span class="ot">&lt;-</span> d1864 <span class="sc">%&gt;%</span></span>
<span id="cb157-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(clusters_df, <span class="at">by =</span> <span class="st">&quot;id&quot;</span>)</span></code></pre></div>
<p>Let’s print out a few clusters:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb158-1" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> d1864_clustering <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cluster <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb158-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(text)</span>
<span id="cb158-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb158-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(cluster, <span class="at">table.attr =</span> <span class="st">&quot;class=</span><span class="sc">\&quot;</span><span class="st">striped</span><span class="sc">\&quot;</span><span class="st">&quot;</span>, <span class="at">format=</span><span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table class="striped">
<thead>
<tr>
<th style="text-align:left;">
text
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Twelve Hundred and fifty Dollars reward. – A reward of two Hundred and fifty Dollars will be paid for the delivery to me, in this city, of each one of the following Slaves, who have absconded from the Carbon Hill Mines, in this county, during the past six months: Charles, a mulatto, about five feet nine inches in height, thirty-two years old, not stout, with very noticeable grey eyes; from Orange county. Daniel, a dark brown negro, about five feet eight inches in height, nineteen or twenty years old, very sprightly countenance, and very talkative. William, dark brown or black, five feet eight or nine inches in height, very slightly made, thirty-two or thirty-four years old, very quiet in his demeanor; from Gloucester county Virginia. Festus, dark brown, five feet seven or eight inches in height, well made, pleasant countenance and good address, twenty-two to twenty-four years of age. Lewis, black, five feet seven or eight inches in height, square built, but not very stout; twenty-eight or thirty years of age; limps slightly. The two latter have relations living in Richmond, and have been employed for some years in Manchester. John J. Werth, Agent. de 2 – 2aw4w
</td>
</tr>
<tr>
<td style="text-align:left;">
50 dollars reward. – Ran away from my farm, near White Oak Swamp bridge, my negro boy Mitchell. Said negro is about 18 years old, black, five feet high, has a scar over the left temple; had on when last seen a slouched hat and black woolen pants; supposed to be lurking about Richmond. The above reward will be given if delivered at my farm, or Mr. Jack Fisher’s. Loftin D. Allen. Henrico county. je 10 – cod3t
</td>
</tr>
<tr>
<td style="text-align:left;">
One hundred and fifty dollars reward. – Ran away, on Monday, 17th instant, a Negro Boy, sixteen years old; about five feet eight or nine inches high, very nearsighted, and black, with a scar on the left cheek, under the eye. He has been seen in the city every day. The above reward will be paid for his delivery at the New Richmond Theatre, corner Seventh and Broad streets. oc 21 – ts
</td>
</tr>
<tr>
<td style="text-align:left;">
50 dollars reward. – Ran away on Monday, the 18th inst, from Mrs Lucy C Binford, , a negro girl about eighteen years old, well grown, dark brown, slender made — She was at the head of Mechanicsville Turnpike, Hanover county, and she is probably lurking about that neighborhood. She has a husband living with Dr John G Lempkis. I will pay the above reward if delivered to me, or secured in jail so that I can get her. J. B. Keesee, Adm’r of W. M. A. Binford, dec’d. Henrico co, July 25, 1864 jy 26 – 2t
</td>
</tr>
<tr>
<td style="text-align:left;">
500 dollars reward. – I will give the above reward for the apprehension of, and delivery to me; at my office, or his lodgement in jail so that I can get him) of my servant boy George Henry Ray. Said boy is a bright mulatto, about five feet high, wooly hair, has a swaggering walk, speaks very quick, and has a very sullen look. He may possibly be lurking about the city, as he has acquaintances in every part of it, but my impression is that he is endeavoring to get to Fredericksburg, from thence to Stafford, to the farm of the late Major John Seddon where he has a father.) in order to pass the lines. Soldiers in the camps are cautioned against employing said boy. M A Blackman, Surgeon and Dentist, No. 83 Main street, Richmond, Va. As he has been accompanying the to the hospitals, he has a pass from Capt Coke, requesting the guard to pass him unmolested. M A B. jy 22 – ts
</td>
</tr>
<tr>
<td style="text-align:left;">
Ran away – From the gravel train on Sunday, 28th ult, four negroes, named Ned, Frederick, Efford, and Albert, hired of Mrs. A C Isbell, of Cumberland county. Efford and Albert are of a bright gingerbread color, 5 feet 10 inches high; Ned and Frederick are of dark complexion, stout, 5 feet 7 inches high. The usual reward will be paid for their apprehension. C G Talbott. Supt Richmond and Denville R R. mh 6 – ts
</td>
</tr>
<tr>
<td style="text-align:left;">
200 dollars reward. – Ranaway from the subscriber about the 17th of January last, two slaves, named Doctor and Raleigh commonly called Flem. Both are black, quick, active man. – Doctor is about 19 years old, had his left hand hurt in an apple mill and scarred on the outside, and has lost one or more of his nails from that hand. He had on a red flannel shirt when he left. Flem is left handed, and is about 17 years of age. I will give $100 a piece for the delivery to me, or to some jail from which I can get them, of the said slaves, if caught out of the county of Charlotte, or $50 a piece if apprehended in the county. I believe they are passing as free men, and are trying to get employment on the Richmond and Danville, or Southside Railroad. Address, Henry E. Edmunds, Moesingford P. O., Charlotte county. Va. fe 16 – 1m
</td>
</tr>
<tr>
<td style="text-align:left;">
200 dollars reward. – Ran off on 19th March a negro woman named Creasy, a very small black woman, thick lips, and large nose, and very short spoken. Carried off with her two new striped homespun yarn dresses, one brown and the other black. The above reward will be given for her apprehension if taken out of the county, at one hundred if taken in the county, in either case to be delivered to me or secured in jail so I get her again. William Priddy. Negro Foot P. O., Hanover co, Va. ap 2 – 6t
</td>
</tr>
<tr>
<td style="text-align:left;">
300 dollars reward – will be paid for the delivery of my servant girl Carellec, who left on Tuesday morning, the 1st instant. She is black, about 18 years of age, well grown, rather stout, has round face and thick lips. A Rodeker, Druggist, No. 19 Main st. au 6 –
</td>
</tr>
<tr>
<td style="text-align:left;">
Five hundred dollars reward. – Ran away from the Richmond Arsenal, where he was hired, about the 20th of July, my negro man, Peter miles, sometimes called Peter Redd. He is twenty-two or twenty-three years of age, five feet eight or nine inches high, gingerbread color, rather a long face, nose rather long and flat, and carries himself very erect. When he left the arsenal be wore a grey jacket and cap. He is no doubt making an effort to pass through our lines. I will give the above reward if caught beyond the limits of the city, or two hundred and fifty dollars if caught within the corporate limits and secured in any jail so that I get him. Neal McCURDY. au 10 – 6t*
</td>
</tr>
<tr>
<td style="text-align:left;">
Ran away from my Farm, at the Half-way House, on the Richmond and Petersburg railroad, Chesterfield country, my man Richard. He left my farm last Tuesday morning, the 9th instant, and had on when he left a pair of dark pants, white cotton shirt, and had on a pair of shoes, no coat nor hat. He is about twenty or twenty-one years old, five feet six or seven inches high, black, has a small moustache, and speaks slow. I bought him last April, of Lee &amp; Bowman, in Richmond. He formerly belonged to Miss Margaret Bottom, of Amelia Courthouse. He has a wife at or near Amelia Courthouse, and may be trying to go there. He was last seen near the Half-Way Station. I will pay a liberal reward if caught and put in jail, or delivered to me. Address J. M. Wolff, 64 Main street, Richmond, Va., or Proctor’s Creek, Chesterfield county. au 17 – 6t*
</td>
</tr>
<tr>
<td style="text-align:left;">
Ranaway. – $100 reward. – From the subscriber, in 10th March, 1864, my men Washington, again about 26 years, about complexion, large mouth will be given if taken out of the State, and if taken in it, and secured so I get him. My address in Fork Union, Fluvanna co, Va., Samuel R. Pellet. ap 26 – 1aw4t
</td>
</tr>
<tr>
<td style="text-align:left;">
100 Dollars reward. – Ranaway from the Midlothian Coal Mines, a negro man named Joe, or Joe Hampton. He is about 25 years old, of dark brown color, spare made, about 5 feet 10 inches high, with rather large eyes, and somewhat wild expression of countenance, though generally smiling when spoken to. He was bought in January last of Mr C C Burton, near Petersburg, where his friends and connexions are, and he is probably in the neighborhood of that place. The above reward will be paid for his apprehension and delivery in any jail, or to the agent of the Company, at their mines, or in Richmond. my 12 – ts
</td>
</tr>
<tr>
<td style="text-align:left;">
Ruanaway. – $100 reward will be paid for the delivery to S N Davis &amp; Co. of a negro boy named John. He is about 18 years old, gingerbread color; he had on a black felt hat, boots tipped on the toes, and gray pantaloons, when he left Friday. He was raised in Albemarle, by Dr. T J Cook Geo. Turner mh 14 – 6t
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb159-1" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> d1864_clustering <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cluster <span class="sc">==</span> <span class="dv">7</span>) <span class="sc">%&gt;%</span></span>
<span id="cb159-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(text)</span>
<span id="cb159-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb159-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb159-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(cluster, <span class="at">table.attr =</span> <span class="st">&quot;class=</span><span class="sc">\&quot;</span><span class="st">striped</span><span class="sc">\&quot;</span><span class="st">&quot;</span>, <span class="at">format=</span><span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table class="striped">
<thead>
<tr>
<th style="text-align:left;">
text
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
For rent – A store neatly fitted up, and the best stand in the town. Apply to John Perry, Ashland Hotel. fe 6 – 2t*
</td>
</tr>
<tr>
<td style="text-align:left;">
For Rent – Two nicely furnishes rooms, suitable for ladies and gentlemen, or gentlemen, with use of parlor and kitchen. Apply at the corner house on the north corner of Marshall and Adams streets. mh 7 – 1t*
</td>
</tr>
<tr>
<td style="text-align:left;">
Shockoe Mill, Seventeenth street, across the Dock. Wheat and Corn ground on tell. For sale – Nice New Flour at $1. 25 per pound. Corn Meal at $55 per bushel. au 4 – 10t* For Rent and Sale.
</td>
</tr>
<tr>
<td style="text-align:left;">
For Rent, a furnished House in a pleasant part of the city. For terms, address " E. S.," with references, Dispatch office. se 12 – 3t*
</td>
</tr>
<tr>
<td style="text-align:left;">
For Rent, a very desirable Dwelling-House, with eight rooms, a spacious yard, out-houses, &amp; c., on Nineteenth street, one door from Grace. Possession given on 1st October. Apply to Mrs. Branch, Franklin street, between Eighteenth and Nineteenth. se 12 – eod3t*
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb160-1" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> d1864_clustering <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cluster <span class="sc">==</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb160-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(text)</span>
<span id="cb160-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb160-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(cluster, <span class="at">table.attr =</span> <span class="st">&quot;class=</span><span class="sc">\&quot;</span><span class="st">striped</span><span class="sc">\&quot;</span><span class="st">&quot;</span>, <span class="at">format=</span><span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<table class="striped">
<thead>
<tr>
<th style="text-align:left;">
text
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Silk culture. Some of our citizens are disposed to turn their attention to the culture of silk. It would afford a new and most profitable employment to women and children. Many years ago there was a great deal of silk produced in this State. The morus multicaulis was extensively cultivated, and almost every house had its room devoted to silk worms, and their feeding and spinning. The business was abandoned, however, and the multicaulis trees were taken up by the roots, and cast out upon the highways to die. Yet there are no doubt some scattering bushes which escaped the general massacre which occurred when it was concluded that the enterprise was unprofitable. Moreover, it may be that some person having faith in the old adage that everything — the most useless, even — comes in use once in seven years, may have saved and kept on hand a small stock of the silk worms. There is now an enquiry for them, and if anybody has ever so small a family, their eggs will sell almost as high as hen’s eggs. The have but to announce that they have the genuine silk worm, to invite orders from every direction.
</td>
</tr>
<tr>
<td style="text-align:left;">
50 Dollars reward. – Stolen from the residence of James Sinton, Jr, on Franklin st, on Sunday, the 8th last, one new large black Silk Circular, trimmed with white buttons. Also, one Stella Shawl. The above reward will be given for the return of the articles to the " Illustrated News Office," and no questions asked. my 9 – 3t
</td>
</tr>
<tr>
<td style="text-align:left;">
Blockade Goods. – Mantle Depot, 60 Main, between 14th and 15th streets. – Ladies’silk parasols, large sizes; white silk illusion; superior quality bonnet ribbons; blond laces; blk silk lacer; blk English crapes; blk English crapes; blk dress silk; bonnet frames; checked muslins, jaconets; cambrics; bleached cotton; extra heavy English cotton hose; lists hose; crape collars; palm leaf fans; black alpacas; castile soap; Ezekiel’s hair tonic; tooth brushes; pomades; collogue, &amp; c, &amp; c. Mantle Depot, 69 Main, bet 14th and 15th sts jy 11 – 3t*
</td>
</tr>
</tbody>
</table>
</div>
<div id="determining-the-optimal-number-of-clusters-elbow-method-and-average-silhouette-method" class="section level3" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Determining the optimal number of clusters: “Elbow Method” and “Average Silhouette Method”</h3>
<p>In a nutshell, we repeatedly run clustering, increasing the number of clusters by one, and calculate the total within-cluster sum of square (<em>wss</em>). We then plot the curve of <em>wss</em> and look for a point in the curve with the sharpest bend (hence the “elbow”), which is considered to be an indicator of the appropriate number of clusters. <code>library(factoextra)</code> can perform this with a single command:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">786</span>)</span>
<span id="cb161-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(<span class="fu">as.matrix</span>(distanceMatrixHC), <span class="at">FUN =</span> hcut, <span class="at">k.max=</span><span class="dv">10</span>, <span class="at">method =</span> <span class="st">&quot;wss&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-101-1.png" width="672" /></p>
<p>Ideally, we sould have something like <code>L</code> or <code>V</code>. Here, perhaps, 3 is our optimal number. We can try another method — <em>average silhouette method</em> (which is also easily callable from <code>library(factoextra)</code>). Like with <em>elbow method</em>, we run clustering multiple times but here we measures the quality of a clustering, but determining how well each object lies within its cluster. A high average silhouette width indicates a good clustering.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">786</span>)</span>
<span id="cb162-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(<span class="fu">as.matrix</span>(distanceMatrixHC), <span class="at">FUN =</span> hcut, <span class="at">k.max =</span> <span class="dv">10</span>, <span class="at">method =</span> <span class="st">&quot;silhouette&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
<p>More on hierarchical clustering: “Hierarchical Cluster Analysis”, in in <em>U of Cincinnati Business Analytics R Programming Course</em> <a href="http://uc-r.github.io/hc_clustering" class="uri">http://uc-r.github.io/hc_clustering</a>.</p>
</div>
</div>
<div id="k-means-clustering" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> K-means clustering</h2>
<p>Let’s get a different sample from our data. With k-means clustering we can run on more data:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RANDOMLY SELECT N ITEMS</span></span>
<span id="cb163-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">48965</span>)</span>
<span id="cb163-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb163-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-4" aria-hidden="true" tabindex="-1"></a>sampledIDs <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">unique</span>(df_TF_IDF<span class="sc">$</span>id), N)</span>
<span id="cb163-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-5" aria-hidden="true" tabindex="-1"></a>sample_d1864_tfidf <span class="ot">&lt;-</span> df_TF_IDF <span class="sc">%&gt;%</span> <span class="fu">filter</span>(id <span class="sc">%in%</span> sampledIDs) <span class="sc">%&gt;%</span></span>
<span id="cb163-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, word, tf_idf)</span>
<span id="cb163-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-8"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-8" aria-hidden="true" tabindex="-1"></a><span class="co"># CONVERT INTO DTM MATRIX</span></span>
<span id="cb163-9"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sample_d1864_tfidf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;document&quot;</span>, <span class="st">&quot;term&quot;</span>, <span class="st">&quot;count&quot;</span>)</span>
<span id="cb163-10"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-10" aria-hidden="true" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">tibble</span>(sample_d1864_tfidf) <span class="sc">%&gt;%</span> <span class="fu">cast_dtm</span>(document, term, count)</span>
<span id="cb163-11"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-11" aria-hidden="true" tabindex="-1"></a>sample_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(sample)</span>
<span id="cb163-12"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-13"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-13" aria-hidden="true" tabindex="-1"></a><span class="co"># CONVERT INTO REGULAR MATRIC AND CALCULATE DISTANCES</span></span>
<span id="cb163-14"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-14" aria-hidden="true" tabindex="-1"></a>distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist.cosine</span>(sample_matrix) <span class="co"># from library(stylo)</span></span>
<span id="cb163-15"><a href="text-analysis-iii-finding-groups-of-texts.html#cb163-15" aria-hidden="true" tabindex="-1"></a>distanceMatrixKM <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(distanceMatrix)</span></code></pre></div>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb164-1" aria-hidden="true" tabindex="-1"></a>kmeansClusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(distanceMatrixKM, <span class="at">centers=</span><span class="dv">5</span>, <span class="at">nstart=</span><span class="dv">25</span>)</span>
<span id="cb164-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(kmeansClusters)</span></code></pre></div>
<pre><code>## List of 9
##  $ cluster     : Named int [1:1000] 2 2 2 2 2 2 5 2 2 2 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:1000] &quot;1864-01-28_article_49&quot; &quot;1864-10-10_printrun_6&quot; &quot;1864-10-10_advert_3&quot; &quot;1864-06-22_article_22&quot; ...
##  $ centers     : num [1:5, 1:1000] 1 0.997 1 1 1 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : chr [1:1000] &quot;1864-01-28_article_49&quot; &quot;1864-10-10_printrun_6&quot; &quot;1864-10-10_advert_3&quot; &quot;1864-06-22_article_22&quot; ...
##  $ totss       : num 2199
##  $ withinss    : num [1:5] 9.03 1313.82 84.42 186.05 9.94
##  $ tot.withinss: num 1603
##  $ betweenss   : num 595
##  $ size        : int [1:5] 12 806 37 121 24
##  $ iter        : int 3
##  $ ifault      : int 0
##  - attr(*, &quot;class&quot;)= chr &quot;kmeans&quot;</code></pre>
<p>We can extract cluster information in the same manner as with <code>hclust()</code> object:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb166-1" aria-hidden="true" tabindex="-1"></a>kmeans_clusters_df <span class="ot">&lt;-</span> <span class="fu">stack</span>(kmeansClusters<span class="sc">$</span>cluster)</span>
<span id="cb166-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(kmeans_clusters_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;cluster&quot;</span>, <span class="st">&quot;id&quot;</span>)</span>
<span id="cb166-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb166-3" aria-hidden="true" tabindex="-1"></a>kmeans_clusters_df <span class="ot">&lt;-</span> kmeans_clusters_df <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, cluster)</span>
<span id="cb166-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(kmeans_clusters_df)</span></code></pre></div>
<pre><code>##                      id cluster
## 1 1864-01-28_article_49       2
## 2 1864-10-10_printrun_6       2
## 3   1864-10-10_advert_3       2
## 4 1864-06-22_article_22       2
## 5 1864-04-16_article_26       2
## 6 1864-03-07_advert_112       2</code></pre>
<p>We can visualize the results of our kmeans clustering using <code>fviz_cluster()</code> (from <code>factoextra</code>). Our data is multidimensional — each word in our matrix is a single dimension, so this function will perform principal component analysis (PCA) and plot data according to the first two principal components that explain majority of the variance in our dataset.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">786</span>)</span>
<span id="cb168-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(kmeansClusters, <span class="at">data =</span> distanceMatrix, <span class="at">labelsize =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
<div id="determining-the-optimal-number-of-clusters-elbow-method-and-average-silhouette-method-1" class="section level3" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> Determining the optimal number of clusters: “Elbow Method” and “Average Silhouette Method”</h3>
<p>In a nutshell, we repeatedly run clustering, increasing the number of clusters by one, and calculate the total within-cluster sum of square (<em>wss</em>). We then plot the curve of <em>wss</em> and look for a point in the curve with the sharpest bend (hence the “elbow”), which is considered to be an indicator of the appropriate number of clusters. <code>library(factoextra)</code> can perform this with a single command:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">786</span>)</span>
<span id="cb169-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(<span class="fu">as.matrix</span>(distanceMatrix), kmeans, <span class="at">k.max=</span><span class="dv">20</span>, <span class="at">method =</span> <span class="st">&quot;wss&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-107-1.png" width="672" /></p>
<p>Ideally, we should have something like <code>L</code> or <code>V</code>. Here results do not seem to be very helpful. We can try another method — <em>average silhouette method</em> (which is also easily callable from <code>library(factoextra)</code>). Like with <em>elbow method</em>, we run clustering multiple times but here we measures the quality of a clustering, bu determining how well each object lies within its cluster. A high average silhouette width indicates a good clustering.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">786</span>)</span>
<span id="cb170-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(<span class="fu">as.matrix</span>(distanceMatrix), kmeans, <span class="at">k.max =</span> <span class="dv">20</span>, <span class="at">method =</span> <span class="st">&quot;silhouette&quot;</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
<p>Let’s try to visualize our clusters again:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">786</span>)</span>
<span id="cb171-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb171-2" aria-hidden="true" tabindex="-1"></a>kmeansClusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(distanceMatrixKM, <span class="at">centers=</span><span class="dv">5</span>, <span class="at">nstart=</span><span class="dv">25</span>)</span>
<span id="cb171-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(kmeansClusters, <span class="at">data =</span> distanceMatrix, <span class="at">labelsize =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-109-1.png" width="672" /></p>
<p>Here is, however, an example of where k-means clustering may/can fail: we gave a different starting point to the algorithm and the clustering outcome may be different:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">786</span>)</span>
<span id="cb172-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb172-2" aria-hidden="true" tabindex="-1"></a>kmeansClusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(distanceMatrixKM, <span class="at">centers=</span><span class="dv">5</span>, <span class="at">nstart=</span><span class="dv">50</span>)</span>
<span id="cb172-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(kmeansClusters, <span class="at">data =</span> distanceMatrix, <span class="at">labelsize =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
<p>More information, see:</p>
<ul>
<li>“K-means Cluster Analysis”, in <em>U of Cincinnati Business Analytics R Programming Course</em> <a href="https://uc-r.github.io/kmeans_clustering" class="uri">https://uc-r.github.io/kmeans_clustering</a>.</li>
<li><a href="https://towardsdatascience.com/k-means-clustering-algorithm-applications-evaluation-methods-and-drawbacks-aa03e644b48a" class="uri">https://towardsdatascience.com/k-means-clustering-algorithm-applications-evaluation-methods-and-drawbacks-aa03e644b48a</a></li>
</ul>
</div>
</div>
<div id="other-clustering-methods" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Other “clustering” methods</h2>
<p>Although not cluster analysis techniques strictly speaking, PCA (principal component analysis) and MDS (multi-dimensional scaling) are used in similar ways. We will touch upon these in the context of stylometry.</p>
</div>
<div id="topic-modeling" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> Topic Modeling</h2>
<div id="topics" class="section level3" number="9.6.1">
<h3><span class="header-section-number">9.6.1</span> Topics?</h3>
<div id="example-1" class="section level4" number="9.6.1.1">
<h4><span class="header-section-number">9.6.1.1</span> Example 1</h4>
<p><em>Thursday, March 27, 1862</em></p>
<p><strong>LIGHT ARTILLERY</strong></p>
<p>—I am authorized by the Governor of Virginia to raise a Company of Light Artillery for the war. All those desirous of enlisting in this the most effective arm of the service, would do well to call at once at the office of Johnson &amp; Guigon, Whig Building.</p>
<p>Uniforms and subsistence furnished.</p>
<p>A. B. GUIGON. mh 25—6t</p>
</div>
<div id="example-2" class="section level4" number="9.6.1.2">
<h4><span class="header-section-number">9.6.1.2</span> Example 2</h4>
<p><em>Wednesday, August 17, 1864</em></p>
<p><strong>Royal Marriages.</strong></p>
<p>—There is a story circulated in Germany, and some in Paris, that the match between the heir-apparent of the Imperial throne of Russia and the Princess Dagmar of Denmark having been definitively broken off, another is in the course of negotiation between His Imperial Highness and the Princess Helens of England.</p>
</div>
<div id="example-3" class="section level4" number="9.6.1.3">
<h4><span class="header-section-number">9.6.1.3</span> Example 3</h4>
<p><em>Monday, June 22, 1863</em></p>
<p><strong>NEWS FROM EUROPE.</strong></p>
<p>The steamship Scotia arrived at New York on Thursday from Europe, with foreign news to the 7th inst. The news is not important. The Confederate steamer Lord Clyde was searched by order of the British Government, but nothing contraband being found on board her she was permitted to sail. The Russians have been defeated near Grochoury by the Polish insurgents. The three Powers have sent an earnest note to Russia, asking for a representative Government, a general amnesty, and an immediate cessation of hostilities in Poland.</p>
</div>
</div>
<div id="getting-to-code" class="section level3" number="9.6.2">
<h3><span class="header-section-number">9.6.2</span> Getting to code</h3>
<p>We can start with our preprocessed variable <code>d1864_clean</code>, which is essentially a cumulative frequency list for all articles.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span>
<span id="cb173-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(topicmodels)</span>
<span id="cb173-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span></code></pre></div>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d1864_clean_minusSW)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
## # Groups:   id [5]
##   id                    word      n
##   &lt;chr&gt;                 &lt;chr&gt; &lt;int&gt;
## 1 1864-09-12_advert_30  mrs     307
## 2 1864-09-12_advert_30  miss    251
## 3 1864-04-18_article_10 mr       84
## 4 1864-08-27_article_41 slave    79
## 5 1864-11-24_article_46 mr       71
## 6 1864-04-26_article_8  enemy    64</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb176-1" aria-hidden="true" tabindex="-1"></a>d1864_dm <span class="ot">&lt;-</span> d1864_clean_minusSW <span class="sc">%&gt;%</span></span>
<span id="cb176-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dtm</span>(id, word, n)</span>
<span id="cb176-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb176-3" aria-hidden="true" tabindex="-1"></a>d1864_dm</span></code></pre></div>
<pre><code>## &lt;&lt;DocumentTermMatrix (documents: 14617, terms: 30391)&gt;&gt;
## Non-/sparse entries: 1162644/443062603
## Sparsity           : 100%
## Maximal term length: 32
## Weighting          : term frequency (tf)</code></pre>
<p>Training a model. <strong>NB</strong>: <code>eval=FALSE</code> setting will prevent from running this chunk when you <code>Knit</code> the notebook; but you can still execute it within the notebook, when you run chunks individually</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb178-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb178-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb178-3" aria-hidden="true" tabindex="-1"></a>d1864_lda <span class="ot">&lt;-</span> <span class="fu">LDA</span>(d1864_dm, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">seed =</span> <span class="dv">1234</span>))</span>
<span id="cb178-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb178-4" aria-hidden="true" tabindex="-1"></a>d1864_lda</span>
<span id="cb178-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb178-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb178-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb178-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-8"><a href="text-analysis-iii-finding-groups-of-texts.html#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="co">#A LDA_VEM topic model with 2 topics.</span></span>
<span id="cb178-9"><a href="text-analysis-iii-finding-groups-of-texts.html#cb178-9" aria-hidden="true" tabindex="-1"></a><span class="co">#35.962 sec elapsed</span></span>
<span id="cb178-10"><a href="text-analysis-iii-finding-groups-of-texts.html#cb178-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-11"><a href="text-analysis-iii-finding-groups-of-texts.html#cb178-11" aria-hidden="true" tabindex="-1"></a><span class="co">#A LDA_VEM topic model with 4 topics.</span></span>
<span id="cb178-12"><a href="text-analysis-iii-finding-groups-of-texts.html#cb178-12" aria-hidden="true" tabindex="-1"></a><span class="co">#72.545 sec elapsed</span></span></code></pre></div>
<p><strong>Do not run this in class: it takes too long!</strong></p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb179-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb179-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb179-3" aria-hidden="true" tabindex="-1"></a>kVal <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb179-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb179-4" aria-hidden="true" tabindex="-1"></a>d1864_lda_better <span class="ot">&lt;-</span> <span class="fu">LDA</span>(d1864_dm, <span class="at">k=</span>kVal, <span class="at">control=</span><span class="fu">list</span>(<span class="at">seed=</span><span class="dv">1234</span>))</span>
<span id="cb179-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span>
<span id="cb179-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb179-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-8"><a href="text-analysis-iii-finding-groups-of-texts.html#cb179-8" aria-hidden="true" tabindex="-1"></a><span class="co">#A LDA_VEM topic model with 20 topics.</span></span>
<span id="cb179-9"><a href="text-analysis-iii-finding-groups-of-texts.html#cb179-9" aria-hidden="true" tabindex="-1"></a><span class="co">#1261.087 sec elapsed (21 minutes)</span></span>
<span id="cb179-10"><a href="text-analysis-iii-finding-groups-of-texts.html#cb179-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-11"><a href="text-analysis-iii-finding-groups-of-texts.html#cb179-11" aria-hidden="true" tabindex="-1"></a><span class="co">#A LDA_VEM topic model with 25 topics.</span></span>
<span id="cb179-12"><a href="text-analysis-iii-finding-groups-of-texts.html#cb179-12" aria-hidden="true" tabindex="-1"></a><span class="co">#1112.262 sec elapsed (18 minutes)</span></span></code></pre></div>
<p>Save/load the model, so that there is no need to regenerate it every time.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co">#d1864_lda_vem_25t_better &lt;- d1864_lda_better</span></span>
<span id="cb180-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="co">#save(d1864_lda_vem_25t_better, file=&quot;./files/data/d1864_lda_vem_25t_better.rda&quot;)</span></span>
<span id="cb180-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="co">#load(file=&quot;./data/d1864_lda_vem_25t_better.rda&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span><span class="st">&quot;./files/data/d1864_lda_vem_25t_better.rda&quot;</span>)</span>
<span id="cb181-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb181-2" aria-hidden="true" tabindex="-1"></a>lda_model <span class="ot">&lt;-</span> d1864_lda_vem_25t_better</span>
<span id="cb181-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb181-3" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> d1864</span></code></pre></div>
<p>From this point on, the code should simply run — if you rename your own model produced above to <code>lda_model</code>.</p>
</div>
<div id="per-topic-per-word-probabilities-beta" class="section level3" number="9.6.3">
<h3><span class="header-section-number">9.6.3</span> Per-topic-per-word probabilities (<em>beta</em>)</h3>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb182-1" aria-hidden="true" tabindex="-1"></a>lda_model_better_topic_term_prob <span class="ot">&lt;-</span> <span class="fu">tidy</span>(lda_model, <span class="at">matrix=</span><span class="st">&quot;beta&quot;</span>)</span>
<span id="cb182-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb182-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb182-3" aria-hidden="true" tabindex="-1"></a>lda_model_better_topic_term_prob <span class="sc">%&gt;%</span></span>
<span id="cb182-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">&quot;bonds&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb182-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb182-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(beta))</span></code></pre></div>
<pre><code>## # A tibble: 25 × 3
##    topic term      beta
##    &lt;int&gt; &lt;chr&gt;    &lt;dbl&gt;
##  1     8 bonds 3.53e- 2
##  2     9 bonds 5.05e- 4
##  3    24 bonds 3.92e- 4
##  4    11 bonds 2.34e-13
##  5     2 bonds 2.13e-13
##  6     1 bonds 3.67e-16
##  7    16 bonds 2.01e-20
##  8    14 bonds 3.08e-21
##  9    18 bonds 3.87e-22
## 10     3 bonds 2.00e-22
## # … with 15 more rows</code></pre>
<p><strong>NB:</strong> This step may throw an error. The error seems a bit cryptic, but restarting R (without saving workspace) seems to help. (<em>beta</em> stands for term-per-topic probability).</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb184-1" aria-hidden="true" tabindex="-1"></a>top_terms <span class="ot">&lt;-</span> lda_model_better_topic_term_prob <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb184-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">15</span>, beta) <span class="sc">%&gt;%</span></span>
<span id="cb184-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb184-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb184-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb184-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(topic, <span class="sc">-</span>beta)</span>
<span id="cb184-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb184-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb184-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(top_terms)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   topic term          beta
##   &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
## 1     1 york       0.0113 
## 2     1 mr         0.0102 
## 3     1 lincoln    0.00915
## 4     1 union      0.00827
## 5     1 states     0.00809
## 6     1 washington 0.00689</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb186-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb186-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb186-3" aria-hidden="true" tabindex="-1"></a>graph <span class="ot">&lt;-</span> top_terms <span class="sc">%&gt;%</span></span>
<span id="cb186-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb186-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder</span>(term, beta)) <span class="sc">%&gt;%</span></span>
<span id="cb186-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb186-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(term, beta, <span class="at">fill =</span> <span class="fu">factor</span>(topic))) <span class="sc">+</span></span>
<span id="cb186-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb186-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb186-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb186-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>topic, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb186-8"><a href="text-analysis-iii-finding-groups-of-texts.html#cb186-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p>Here it is in a bit of a better quality:</p>
<p><img src="files/data/topics.png" /></p>
<p>Topic-per-document probabilities: this object will tell us to which topics documents belong (and to what extent): (<em>gamma</em> stands for topic-per-document probability).</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb187-1" aria-hidden="true" tabindex="-1"></a>lda_model_topic_doc_prob <span class="ot">&lt;-</span> <span class="fu">tidy</span>(lda_model, <span class="at">matrix=</span><span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb187-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb187-2" aria-hidden="true" tabindex="-1"></a>lda_model_topic_doc_prob</span></code></pre></div>
<pre><code>## # A tibble: 356,150 × 3
##    document              topic     gamma
##    &lt;chr&gt;                 &lt;int&gt;     &lt;dbl&gt;
##  1 1864-09-12_advert_30      1 0.0000115
##  2 1864-04-18_article_10     1 0.709    
##  3 1864-08-27_article_41     1 0.0000581
##  4 1864-11-24_article_46     1 0.0614   
##  5 1864-04-26_article_8      1 0.0000152
##  6 1864-05-09_article_1      1 0.0000152
##  7 1864-05-14_article_23     1 0.139    
##  8 1864-05-16_article_6      1 0.122    
##  9 1864-06-27_article_2      1 0.0000270
## 10 1864-04-16_article_15     1 0.620    
## # … with 356,140 more rows</code></pre>
<ol start="12" class="example" style="list-style-type: decimal">
<li>Pick a document and print out topics it belongs to (from the most prominent to less prominent). (Hint: use the object we just created &gt; filter &gt; arrange).</li>
</ol>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code></pre></div>
<p>Top N documents per topic: this will create an object with top N documents per each topic.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb190-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb190-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb190-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb190-3" aria-hidden="true" tabindex="-1"></a>top_docs <span class="ot">&lt;-</span> lda_model_topic_doc_prob <span class="sc">%&gt;%</span></span>
<span id="cb190-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb190-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(N, gamma) <span class="sc">%&gt;%</span></span>
<span id="cb190-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb190-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb190-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb190-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(topic, <span class="sc">-</span>gamma)</span>
<span id="cb190-8"><a href="text-analysis-iii-finding-groups-of-texts.html#cb190-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-9"><a href="text-analysis-iii-finding-groups-of-texts.html#cb190-9" aria-hidden="true" tabindex="-1"></a>top_docs</span></code></pre></div>
<pre><code>## # A tibble: 285 × 3
##    document               topic gamma
##    &lt;chr&gt;                  &lt;int&gt; &lt;dbl&gt;
##  1 1864-09-14_article_65      1 0.992
##  2 1864-08-31_article_103     1 0.989
##  3 1864-09-08_article_34      1 0.984
##  4 1864-04-19_article_30      1 0.980
##  5 1864-03-23_article_68      1 0.977
##  6 1864-06-03_article_12      1 0.965
##  7 1864-12-29_article_47      1 0.957
##  8 1864-03-10_article_118     1 0.956
##  9 1864-06-08_article_15      1 0.940
## 10 1864-09-01_article_65      1 0.939
## # … with 275 more rows</code></pre>
<p>Now that we have IDs of representative documents, we can check those documents one by one, but let’s do something else first: topic-title function—–it is not really necessary, but it will combine together topic number (from the model) and its top words, which can be used for graphs.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb192-1" aria-hidden="true" tabindex="-1"></a>topicVar <span class="ot">&lt;-</span> <span class="cf">function</span>(top, topTerms){</span>
<span id="cb192-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb192-2" aria-hidden="true" tabindex="-1"></a>  topicVar <span class="ot">&lt;-</span> topTerms <span class="sc">%&gt;%</span></span>
<span id="cb192-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb192-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(topic <span class="sc">==</span> top) <span class="sc">%&gt;%</span></span>
<span id="cb192-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb192-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="sc">-</span>beta)</span>
<span id="cb192-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb192-5" aria-hidden="true" tabindex="-1"></a>  vals <span class="ot">=</span> <span class="fu">paste</span>(topicVar<span class="sc">$</span>term, <span class="at">collapse=</span><span class="st">&quot;, &quot;</span>)</span>
<span id="cb192-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb192-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.String</span>(<span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">&quot;Topic &quot;</span>, top, <span class="st">&quot;: &quot;</span>, vals), <span class="at">collapse=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb192-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb192-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb193-1" aria-hidden="true" tabindex="-1"></a>topicNum <span class="ot">=</span> <span class="dv">8</span> </span>
<span id="cb193-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb193-2" aria-hidden="true" tabindex="-1"></a>idTest   <span class="ot">=</span> <span class="st">&quot;1864-08-31_orders_74&quot;</span></span>
<span id="cb193-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb193-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="fu">topicVar</span>(topicNum, top_terms)</span></code></pre></div>
<pre><code>## Topic 8: treasury, bonds, notes, 1864, states, cent, certificates, confederate, secretary, department, america, richmond, payment, interest, treasurer</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;---&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;---&quot;</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.String</span>(d1864[d1864<span class="sc">$</span>id<span class="sc">==</span>idTest, ][<span class="st">&quot;text&quot;</span>])</span></code></pre></div>
<pre><code>## Treasury Department, Confederate States of America, Richmond, August 8, 1864. Certificates of Indebtedness Bearing Six Per Cent. Per Annum interest and Free from Taxation. -- By the fourteenth section of the act to reduce the currency, approved February 17, 1864, the Secretary of the Treasury is authorized to issue the above certificates, payable two years after the ratification of a treaty of peace with the United States. They cannot be sold, but are only to be issued to such creditors of the Government as are willing to receive the same in payment of their demands. They must also be given at par, though free from taxation. The attention of purchasing agents and disbursing officers of the Government is called to this class of public securities as offering peculiar advantages to those from whom the supplies of the Government are bought; and to facilitate the use of them, checks drawn by disbursing officers upon the depositaries holding these funds, and marked across the face &quot; payable in certificates of indebtedness,&quot; will be paid in conformity therewith. Depositaries are hereby authorized and required to comply with this regulation, and to make application to the Register for supplies of certificates as required. Signed) G. A. Trenholm, Secretary of Treasury. au 22 -- ts</code></pre>
</div>
<div id="topics-over-time" class="section level3" number="9.6.4">
<h3><span class="header-section-number">9.6.4</span> Topics over time</h3>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb199-1" aria-hidden="true" tabindex="-1"></a>corpus_light <span class="ot">&lt;-</span> corpus <span class="sc">%&gt;%</span></span>
<span id="cb199-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>header, <span class="sc">-</span>text)</span>
<span id="cb199-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb199-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb199-4" aria-hidden="true" tabindex="-1"></a>lda_model_topics <span class="ot">&lt;-</span> lda_model_topic_doc_prob <span class="sc">%&gt;%</span></span>
<span id="cb199-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id=</span>document) <span class="sc">%&gt;%</span></span>
<span id="cb199-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb199-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(corpus_light, <span class="at">by=</span><span class="st">&quot;id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb199-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb199-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(topic, date) <span class="sc">%&gt;%</span></span>
<span id="cb199-8"><a href="text-analysis-iii-finding-groups-of-texts.html#cb199-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">freq=</span><span class="fu">sum</span>(gamma))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;topic&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb201-1" aria-hidden="true" tabindex="-1"></a>lda_model_topics</span></code></pre></div>
<pre><code>## # A tibble: 7,725 × 3
## # Groups:   topic [25]
##    topic date        freq
##    &lt;int&gt; &lt;date&gt;     &lt;dbl&gt;
##  1     1 1864-01-01 0.219
##  2     1 1864-01-02 0.731
##  3     1 1864-01-04 1.02 
##  4     1 1864-01-05 0.587
##  5     1 1864-01-06 0.708
##  6     1 1864-01-07 1.35 
##  7     1 1864-01-08 0.400
##  8     1 1864-01-09 0.580
##  9     1 1864-01-11 0.838
## 10     1 1864-01-12 0.783
## # … with 7,715 more rows</code></pre>
<p>Now, we can plot topic distribution over time:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb203-1" aria-hidden="true" tabindex="-1"></a>topicVal <span class="ot">=</span> <span class="dv">8</span></span>
<span id="cb203-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb203-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb203-3" aria-hidden="true" tabindex="-1"></a>lda_model_topics_final <span class="ot">&lt;-</span> lda_model_topics <span class="sc">%&gt;%</span></span>
<span id="cb203-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb203-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(topic <span class="sc">==</span> topicVal)</span>
<span id="cb203-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb203-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb203-6" aria-hidden="true" tabindex="-1"></a>graph2 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="at">x=</span>lda_model_topics_final<span class="sc">$</span>date, <span class="at">y=</span>lda_model_topics_final<span class="sc">$</span>freq, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">1</span>,</span>
<span id="cb203-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb203-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">topicVar</span>(topicVal, top_terms),</span>
<span id="cb203-8"><a href="text-analysis-iii-finding-groups-of-texts.html#cb203-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;1864 - Dispatch coverage&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;topic saliency&quot;</span>); <span class="fu">segments</span>(<span class="at">x0=</span>lda_model_topics_final<span class="sc">$</span>date, <span class="at">x1=</span>lda_model_topics_final<span class="sc">$</span>date, <span class="at">y0=</span><span class="dv">0</span>, <span class="at">y1=</span>lda_model_topics_final<span class="sc">$</span>freq, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="files/data/topic_bonds.png" /></p>
</div>
<div id="exploring-topics" class="section level3" number="9.6.5">
<h3><span class="header-section-number">9.6.5</span> Exploring topics</h3>
<p><code>LDAvis</code> offers a visual browser for topics, which has already became a very popular tool for this purpose. If everything is done right, a visualization similar to the one below should open in a browser.</p>
<div class="figure">
<img src="files/data/LDAvis.png" alt="" />
<p class="caption"><code>LDAvis</code> Browser Example.</p>
</div>
<p>We can use the following function that extracts all needed information from a model and converts it into a format that <code>LDAvis</code> expects:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LDAvis)</span>
<span id="cb204-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(slam)</span>
<span id="cb204-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-4" aria-hidden="true" tabindex="-1"></a>topicmodels2LDAvis <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...){</span>
<span id="cb204-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-5" aria-hidden="true" tabindex="-1"></a>  post <span class="ot">&lt;-</span> topicmodels<span class="sc">::</span><span class="fu">posterior</span>(x)</span>
<span id="cb204-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">ncol</span>(post[[<span class="st">&quot;topics&quot;</span>]]) <span class="sc">&lt;</span> <span class="dv">3</span>) <span class="fu">stop</span>(<span class="st">&quot;The model must contain &gt; 2 topics&quot;</span>)</span>
<span id="cb204-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-7" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> x<span class="sc">@</span>wordassignments</span>
<span id="cb204-8"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-8" aria-hidden="true" tabindex="-1"></a>  LDAvis<span class="sc">::</span><span class="fu">createJSON</span>(</span>
<span id="cb204-9"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">phi =</span> post[[<span class="st">&quot;terms&quot;</span>]], </span>
<span id="cb204-10"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> post[[<span class="st">&quot;topics&quot;</span>]],</span>
<span id="cb204-11"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">vocab =</span> <span class="fu">colnames</span>(post[[<span class="st">&quot;terms&quot;</span>]]),</span>
<span id="cb204-12"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">doc.length =</span> slam<span class="sc">::</span><span class="fu">row_sums</span>(mat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb204-13"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">term.frequency =</span> slam<span class="sc">::</span><span class="fu">col_sums</span>(mat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb204-14"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb204-15"><a href="text-analysis-iii-finding-groups-of-texts.html#cb204-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">serVis</span>(<span class="fu">topicmodels2LDAvis</span>(lda_model))</span></code></pre></div>
<p><strong>NB</strong>: there are some issues with <code>LDAvis</code> and for some reason it does not always parse out a topic model object. We can try loading another one, which does work: this is a 20 topic model based on issues of the Dispatch covering the period of 1861-1864.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file=</span><span class="st">&quot;./files/data/dispatch_lda_vem_better.rda&quot;</span>)</span>
<span id="cb206-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">serVis</span>(<span class="fu">topicmodels2LDAvis</span>(dispatch_lda_vem_better))</span></code></pre></div>
</div>
</div>
<div id="addendum-different-distances-code-sample" class="section level2" number="9.7">
<h2><span class="header-section-number">9.7</span> Addendum: different distances code sample</h2>
<p>This is simply a chunk of code that you can reuse for generating different distances. This code will not run because there is no variable <code>YOUR_MATRIX</code>!</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(stylo)</span></span>
<span id="cb207-2"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-3"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR_MATRIX must be generated before you run the code below</span></span>
<span id="cb207-4"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-5"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-5" aria-hidden="true" tabindex="-1"></a><span class="co"># USING library(stylo) FUNCTIONS</span></span>
<span id="cb207-6"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (distanceMethod <span class="sc">==</span> <span class="st">&quot;cosine&quot;</span>){distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist.cosine</span>(YOUR_MATRIX)</span>
<span id="cb207-7"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-7" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (distanceMethod <span class="sc">==</span> <span class="st">&quot;delta&quot;</span>){distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist.delta</span>(YOUR_MATRIX)</span>
<span id="cb207-8"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (distanceMethod <span class="sc">==</span> <span class="st">&quot;argamon&quot;</span>){distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist.argamon</span>(YOUR_MATRIX)</span>
<span id="cb207-9"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-9" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (distanceMethod <span class="sc">==</span> <span class="st">&quot;eder&quot;</span>){distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist.eder</span>(YOUR_MATRIX)</span>
<span id="cb207-10"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-10" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (distanceMethod <span class="sc">==</span> <span class="st">&quot;minmax&quot;</span>){distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist.minmax</span>(YOUR_MATRIX)</span>
<span id="cb207-11"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (distanceMethod <span class="sc">==</span> <span class="st">&quot;enthropy&quot;</span>){distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist.enthropy</span>(YOUR_MATRIX)</span>
<span id="cb207-12"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-12" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (distanceMethod <span class="sc">==</span> <span class="st">&quot;simple&quot;</span>){distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist.simple</span>(YOUR_MATRIX)</span>
<span id="cb207-13"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-13" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (distanceMethod <span class="sc">==</span> <span class="st">&quot;wurzburg&quot;</span>){distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist.wurzburg</span>(YOUR_MATRIX)</span>
<span id="cb207-14"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-14" aria-hidden="true" tabindex="-1"></a><span class="co"># USING dist() FUNCTION</span></span>
<span id="cb207-15"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-15" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (distanceMethod <span class="sc">==</span> <span class="st">&quot;euclidean&quot;</span>){distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist</span>(YOUR_MATRIX, <span class="at">method=</span><span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb207-16"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-16" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (distanceMethod <span class="sc">==</span> <span class="st">&quot;maximum&quot;</span>){distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist</span>(YOUR_MATRIX, <span class="at">method=</span><span class="st">&quot;maximum&quot;</span>)</span>
<span id="cb207-17"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-17" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (distanceMethod <span class="sc">==</span> <span class="st">&quot;manhattan&quot;</span>){distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist</span>(YOUR_MATRIX, <span class="at">method=</span><span class="st">&quot;manhattan&quot;</span>)</span>
<span id="cb207-18"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-18" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (distanceMethod <span class="sc">==</span> <span class="st">&quot;canberra&quot;</span>){distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist</span>(YOUR_MATRIX, <span class="at">method=</span><span class="st">&quot;canberra&quot;</span>)</span>
<span id="cb207-19"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-19" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (distanceMethod <span class="sc">==</span> <span class="st">&quot;binary&quot;</span>){distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist</span>(YOUR_MATRIX, <span class="at">method=</span><span class="st">&quot;binary&quot;</span>)</span>
<span id="cb207-20"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-20" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (distanceMethod <span class="sc">==</span> <span class="st">&quot;minkowski&quot;</span>){distanceMatrix <span class="ot">&lt;-</span> <span class="fu">dist</span>(YOUR_MATRIX, <span class="at">method=</span><span class="st">&quot;minkowski&quot;</span>)</span>
<span id="cb207-21"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-22"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-22" aria-hidden="true" tabindex="-1"></a>distanceMatrix <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(distanceMatrix)</span>
<span id="cb207-23"><a href="text-analysis-iii-finding-groups-of-texts.html#cb207-23" aria-hidden="true" tabindex="-1"></a>clustered.data <span class="ot">&lt;-</span> <span class="fu">hclust</span>(distanceMatrix, <span class="at">method =</span> clusteringMethod)</span></code></pre></div>
</div>
<div id="HW09" class="section level2" number="9.8">
<h2><span class="header-section-number">9.8</span> Homework</h2>
<ul>
<li>given in the chapter.</li>
</ul>
</div>
<div id="SHW09" class="section level2" number="9.9">
<h2><span class="header-section-number">9.9</span> Submitting homework</h2>
<ul>
<li>Homework assignment must be submitted by the beginning of the next class;</li>
<li>Email your homework to the instructor as attachments.
<ul>
<li>In the subject of your email, please, add the following: <code>57528-LXX-HW-YourLastName-YourMatriculationNumber</code>, where <code>LXX</code> is the number of the lesson for which you submit homework; <code>YourLastName</code> is your last name; and <code>YourMatriculationNumber</code> is your matriculation number.</li>
</ul></li>
</ul>
</div>
<div id="SWH09" class="section level2" number="9.10">
<h2><span class="header-section-number">9.10</span> Additional Materials</h2>
<ul>
<li>Chapter 3 “Analyzing word and document frequency: tf-idf” in: Silge, Julia, and David Robinson. 2017. <em>Text Mining with R: A Tidy Approach</em>. First edition. Beijing Boston Farnham: O´Reilly. <a href="https://www.tidytextmining.com/" class="uri">https://www.tidytextmining.com/</a>. Available online: <a href="https://www.tidytextmining.com/tfidf.html" class="uri">https://www.tidytextmining.com/tfidf.html</a></li>
<li>Chapter 6 “Topic modeling” in: Silge, Julia, and David Robinson. 2017. <em>Text Mining with R: A Tidy Approach</em>. First edition. Beijing Boston Farnham: O´Reilly. <a href="https://www.tidytextmining.com/" class="uri">https://www.tidytextmining.com/</a>. Available online: <a href="https://www.tidytextmining.com/topicmodeling.html" class="uri">https://www.tidytextmining.com/topicmodeling.html</a></li>
<li>Chapter on Topic Modeling in: Benjamin Soltoff. <em>MACS 305001: Computing for the Social Sciences</em>, University of Chicago, <a href="https://cfss.uchicago.edu/notes/topic-modeling/" class="uri">https://cfss.uchicago.edu/notes/topic-modeling/</a></li>
<li>David Meza. <em>Topic Modeling using R</em>, <a href="https://knowledger.rbind.io/post/topic-modeling-using-r/" class="uri">https://knowledger.rbind.io/post/topic-modeling-using-r/</a></li>
<li>Grün, Bettina, and Kurt Hornik. 2011. “Topicmodels: An R Package for Fitting Topic Models.” <em>Journal of Statistical Software</em> 40 (13). <a href="https://doi.org/10.18637/jss.v040.i13" class="uri">https://doi.org/10.18637/jss.v040.i13</a>.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="text-analysis-ii-distances-keywords-summarization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "github"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/EIS1600/course_TM_R_2022S/edit/main/02-Lesson09.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/EIS1600/course_TM_R_2022S/blob/main/02-Lesson09.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

</body>

</html>
